import{c as n}from"./app.43fe0c63.js";import{_ as s}from"./plugin-vue_export-helper.21dcd24c.js";var a="/blog-web/assets/tagdown.a61dbc1c.png",p="/blog-web/assets/tagdown-ui.892e9f23.png",e="/blog-web/assets/tagdown-options-page.d41d00b4.png",t="/blog-web/assets/tagdown-popup-components.7809551f.png",o="/blog-web/assets/tagdown-toggle-folder.3112e95c.gif",c="/blog-web/assets/IndexedDB.5b1590ef.png",l="/blog-web/assets/change-action-icon.2273af65.gif";const u={},r=n('<h1 id="tagdown" tabindex="-1"><a class="header-anchor" href="#tagdown" aria-hidden="true">#</a> TagDown</h1><p><img src="'+a+'" alt="tagdown"></p><p>TagDown \u662F\u4E00\u6B3E\u5F00\u6E90\u7684\u4E66\u7B7E\u7BA1\u7406\u63D2\u4EF6\uFF0C \u60A8\u53EF\u4EE5\u4F7F\u7528\u6269\u5C55\u7A0B\u5E8F<em>\u6D4F\u89C8</em>\u3001<em>\u65B0\u589E</em>\u3001<em>\u4FEE\u6539</em>\u4E66\u7B7E\uFF0C\u5B83\u4E5F\u652F\u6301\u4EE5\u4E0D\u540C\u65B9\u5F0F<em>\u5BFC\u51FA</em>\u4E66\u7B7E\u3002</p><p>\u9664\u4E86\u5E38\u89C1\u7684\u4E66\u7B7E\u7BA1\u7406\u529F\u80FD\uFF0C\u8FD8\u5177\u6709\u4EE5\u4E0B\u7279\u70B9\uFF1A</p><ul><li><p>\u652F\u6301 \u{1F3AC} <a href="https://www.bilibili.com/video/BV1up4y1s7VP?p=4" target="_blank" rel="noopener noreferrer">\u65B0\u589E</a>\u4E66\u7B7E\uFF0C\u5E76\u9644\u52A0\u989D\u5916\u7684\u4FE1\u606F\uFF0C\u4F8B\u5982 <code>tags</code>\u3001<code>groups</code> \u7B49</p></li><li><p>\u652F\u6301 \u{1F3AC} <a href="https://www.bilibili.com/video/BV1up4y1s7VP?p=7" target="_blank" rel="noopener noreferrer">\u5BFC\u51FA</a>\u4EFB\u610F\u4E66\u7B7E\u4E3A <code>json</code> \u6587\u6863</p></li><li><p>\u4EE5 \u{1F3AC} <a href="https://www.bilibili.com/video/BV1up4y1s7VP?p=3" target="_blank" rel="noopener noreferrer">\u6811\u56FE</a>\u7684\u5F62\u5F0F\u6D4F\u89C8\u5C42\u7EA7\u7ED3\u6784\u7684\u4E66\u7B7E\u6570\u636E</p></li><li><p>\u4E00\u952E\u6253\u5F00\u591A\u4E2A\u4E66\u7B7E\uFF0C\u652F\u6301\u5728 \u{1F3AC} <a href="https://www.bilibili.com/video/BV1up4y1s7VP" target="_blank" rel="noopener noreferrer">\u6807\u7B7E\u7EC4</a>\u5185\u6253\u5F00\u4E66\u7B7E</p></li></ul><p>\u672C\u6587\u4E3B\u8981\u8BB0\u5F55\u4E86\u6211\u5728\u5F00\u53D1 TagDown \u6269\u5C55\u7A0B\u5E8F\u8FC7\u7A0B\u4E2D\u7684\u4E00\u4E9B\u5C0F\u6536\u83B7\u3002</p><h2 id="\u8BBE\u8BA1" tabindex="-1"><a class="header-anchor" href="#\u8BBE\u8BA1" aria-hidden="true">#</a> \u8BBE\u8BA1</h2><p>\u8BE5\u6269\u5C55\u7A0B\u5E8F\u4E0E\u7528\u6237\u7684\u4EA4\u4E92\u754C\u9762\u4E3B\u8981\u662F\u901A\u8FC7\u4E00\u4E2A<strong>\u5F39\u51FA\u7A97 popup</strong>\uFF0C\u5F53\u7528\u6237\u70B9\u51FB\u5DE5\u5177\u680F\u4E0A\u6269\u5C55\u7A0B\u5E8F\u7684\u56FE\u6807\u65F6\uFF0C\u4F1A\u5F39\u51FA\u4E00\u4E2A HTML \u9875\u9762\uFF0C\u8BE5\u9875\u9762\u5B9E\u73B0\u4E86\u5927\u90E8\u5206\u6269\u5C55\u7A0B\u5E8F\u7684\u529F\u80FD\u3002</p><p>\u8BE5\u9875\u9762\u6709\u4E24\u79CD\u72B6\u6001\uFF1A</p><ul><li>\u6D4F\u89C8\u72B6\u6001 browser\uFF1A\u7528\u6237\u53EF\u4EE5\u6D4F\u89C8 Chrome \u4E2D\u5DF2\u5B58\u7684\u6240\u6709\u4E66\u7B7E</li><li>\u7F16\u8F91\u72B6\u6001 edit\uFF1A\u7528\u6237\u5728\u7F16\u8F91\u9875\u9762\u53EF\u4EE5\u65B0\u589E\u3001\u4FEE\u6539\u3001\u5220\u9664\u4E66\u7B7E</li></ul><p><img src="'+p+'" alt="UI"></p><p>\u6269\u5C55\u7A0B\u5E8F\u5728\u540E\u53F0\u4F1A\u76D1\u63A7\u6807\u7B7E\u5207\u6362\u6FC0\u6D3B\u72B6\u6001\uFF0C\u4EE5\u5206\u6790\u5F53\u524D\u8BBF\u95EE\u7684 URL \u662F\u5426\u5DF2\u6536\u85CF\u4E3A\u4E66\u7B7E\uFF0C\u52A8\u6001\u5207\u6362\u5DE5\u5177\u680F\u4E0A\u6269\u5C55\u7A0B\u5E8F\u7684\u56FE\u6807\u72B6\u6001\u3002</p><p>\u6269\u5C55\u7A0B\u5E8F\u8FD8\u63D0\u4F9B\u4E00\u4E2A\u914D\u7F6E\u9875\u9762 option page\uFF0C\u53EF\u4EE5\u5BF9 IndexedDB \u6570\u636E\u5E93\u6267\u884C\u5BFC\u51FA\u3001\u5BFC\u5165\u3001\u5220\u9664\u64CD\u4F5C\uFF0C\u8FD8\u53EF\u4EE5\u6309\u9700\u5BFC\u51FA\u4E66\u7B7E\u3002</p><p><img src="'+e+`" alt="option page"></p><p>\u66F4\u8BE6\u7EC6\u7684\u8BBE\u8BA1\u7A3F\u53EF\u4EE5\u67E5\u770B<a href="https://www.figma.com/community/file/1014891055524312843" target="_blank" rel="noopener noreferrer">\u8FD9\u91CC</a>\uFF0C\u8FD8\u6709\u4E00\u4E2A<a href="https://www.figma.com/proto/2Rtmm9uWs4LOAqLviyvveX/TagDown?node-id=1447%3A7484&amp;scaling=scale-down&amp;page-id=1403%3A1050&amp;starting-point-node-id=1447%3A7484&amp;show-proto-sidebar=1" target="_blank" rel="noopener noreferrer">\u539F\u578B</a>\u53EF\u4EE5\u4F53\u9A8C\u6269\u5C55\u7A0B\u5E8F\u7684\u57FA\u672C\u4EA4\u4E92\u3002</p><h2 id="\u9884\u5907\u6280\u80FD" tabindex="-1"><a class="header-anchor" href="#\u9884\u5907\u6280\u80FD" aria-hidden="true">#</a> \u9884\u5907\u6280\u80FD</h2><p>\u672C\u9879\u76EE\u4F7F\u7528 Vue\uFF08Vue 3.0 \u7248\u672C\uFF09\u548C Chrome \u6240\u63D0\u4F9B\u7684 API \u8FDB\u884C\u5F00\u53D1\uFF08\u5F53\u7136\u8FD8\u4F7F\u7528\u4E86\u5FC5\u4E0D\u53EF\u5C11\u7684\u524D\u7AEF\u4E09\u5927\u57FA\u672C\u6280\u80FD HTML\u3001CSS\u3001JavaScript\uFF09\uFF0C\u6B64\u5916 CSS \u4E3B\u8981\u4F7F\u7528 Tailwindcss \u6846\u67B6\u3002</p><ul><li>HTML</li><li>CSS\u3001<a href="https://tailwindcss.com/" target="_blank" rel="noopener noreferrer">Tailwind CSS</a></li><li><a href="https://v3.cn.vuejs.org/" target="_blank" rel="noopener noreferrer">Vue</a>\u3001JavaScript</li><li><a href="https://developer.chrome.com/docs/extensions/reference/" target="_blank" rel="noopener noreferrer">Chrome APIs</a></li></ul><h2 id="\u642D\u5EFA\u5F00\u53D1\u73AF\u5883" tabindex="-1"><a class="header-anchor" href="#\u642D\u5EFA\u5F00\u53D1\u73AF\u5883" aria-hidden="true">#</a> \u642D\u5EFA\u5F00\u53D1\u73AF\u5883</h2><p>\u642D\u5EFA\u4E00\u4E2A\u4F7F\u7528 Vue+Vite+Tailwindcss \u7684\u5F00\u53D1\u73AF\u5883\uFF0C\u5176\u4E2D\u5F00\u53D1\u7684\u6269\u5C55\u7A0B\u5E8F\u5C5E\u4E8E Manifest V3 \u7248\u672C\u3002</p><p>\u{1F4A1} \u7CFB\u7EDF\u5DF2\u7ECF\u5B89\u88C5 node \u73AF\u5883</p><p>\u{1F4A1} \u5982\u679C\u5728\u5F00\u53D1\u4E2D\u4F7F\u7528 VS Code \u6587\u672C\u7F16\u8F91\u5668\uFF0C\u63A8\u8350\u5B89\u88C5 Vue3 \u5F00\u53D1\u7684\u914D\u5957 <a href="https://marketplace.visualstudio.com/items?itemName=johnsoncodehk.volar" target="_blank" rel="noopener noreferrer">Volar</a> \u63D2\u4EF6\u3002</p><p>\u5728\u7EC8\u7AEF\u8F93\u5165\u4EE5\u4E0B\u547D\u4EE4<a href="https://cn.vitejs.dev/guide/#scaffolding-your-first-vite-project" target="_blank" rel="noopener noreferrer">\u521B\u5EFA\u4E00\u4E2A Vue3+Vite \u7684\u9879\u76EE\u6A21\u677F</a></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">npm</span> init vite@latest
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>\u7136\u540E\u6839\u636E\u63D0\u793A\u5B89\u88C5\u4F9D\u8D56\u5305</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># \u5C06\u7EC8\u7AEF\u7684\u8DEF\u5F84\u5207\u6362\u5230\u9879\u76EE\u6587\u4EF6\u5939\u4E2D</span>
<span class="token builtin class-name">cd</span> project-folder
<span class="token comment"># \u5B89\u88C5\u4F9D\u8D56\u5305</span>
<span class="token function">npm</span> <span class="token function">install</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>\u4E3A\u4E86\u5728\u9879\u76EE\u4E2D\u4F7F\u7528 ESLint \u8FDB\u884C\u4EE3\u7801\u89C4\u8303\u7BA1\u7406\uFF0C\u9700\u8981\u5B89\u88C5 <a href="https://eslint.vuejs.org/" target="_blank" rel="noopener noreferrer">eslint-plugin-vue</a> \u6A21\u5757</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> --save-dev eslint eslint-plugin-vue
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>\u7136\u540E\u5728\u7EC8\u7AEF\u8F93\u5165 <code>eslint --init</code> \u547D\u4EE4\u8FDB\u884C\u521D\u59CB\u5316\u914D\u7F6E\uFF0C\u6839\u636E\u81EA\u5DF1\u7684\u7F16\u7A0B\u4E60\u60EF\u548C\u56E2\u961F\u8981\u6C42\uFF0C\u6309\u7167\u63D0\u793A\u8BBE\u7F6E\u4EE3\u7801\u6837\u5F0F\u89C4\u8303\uFF1A</p><ul><li><p><code>To check syntax, find problems, and enforece code style</code></p></li><li><p><code>JavaScript modules (import/export)</code></p></li><li><p><code>Vue.js</code></p></li><li><p><code>Browser</code> &amp; <code>Node</code></p></li><li><p><code>Use a popular style guide</code> -&gt; <code>Airbnb</code></p></li><li><p><code>JavaScript</code></p></li></ul><p>\u7136\u540E\u7CFB\u7EDF\u4F1A\u5B89\u88C5\u6240\u4F9D\u8D56\u7684\u5305\u548C\u751F\u6210 ESLint \u914D\u7F6E\u6587\u4EF6 <code>.eslintrc.js</code></p><p>\u7531\u4E8E\u5728\u9879\u76EE\u4E2D\u4F7F\u7528\u7684\u662F Vue3 \u7248\u672C\uFF0C\u6240\u4EE5\u9700\u8981\u6253\u5F00\u914D\u7F6E\u6587\u4EF6 <code>.eslintrc.js</code> \u8FDB\u884C\u76F8\u5E94\u7684\u4FEE\u6539</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
    <span class="token keyword">extends</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token string">&#39;plugin:vue/vue3-recommended&#39;</span><span class="token punctuation">,</span>
      <span class="token string">&#39;airbnb-base&#39;</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre><div class="highlight-lines"><br><br><br><div class="highlight-line">\xA0</div><br><br><br><br></div><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>\u5982\u679C\u4F7F\u7528 VS Code \u8FDB\u884C\u4EE3\u7801\u7F16\u5199\uFF0C\u9700\u8981\u5728 \u{1F4C1} \u6587\u4EF6\u5939 <code>.vscode</code> \u4E2D\u521B\u5EFA\u4E00\u4E2A\u6587\u4EF6 <code>settings.json</code> \u8FDB\u884C\u7F16\u8F91\u5668\u7684 eslint \u914D\u7F6E</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;editor.codeActionsOnSave&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;source.fixAll.eslint&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;eslint.validate&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token string">&quot;javascript&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;vue&quot;</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>\u{1F4A1} \u66F4\u591A\u5173\u4E8E\u4F7F\u7528 ESLint \u8FDB\u884C\u4EE3\u7801\u89C4\u8303\u7BA1\u7406\u7684\u7EC6\u8282\u53EF\u4EE5\u53C2\u8003\u8BE5 \u{1F3AC} <a href="https://www.bilibili.com/video/BV1pq4y1T75p" target="_blank" rel="noopener noreferrer">\u5F71\u7247</a></p><p>\u7531\u4E8E\u5F00\u53D1 Chrome \u63D2\u4EF6\u9700\u8981\u7279\u6B8A\u7684\u9879\u76EE\u7ED3\u6784\uFF0C\u4F8B\u5982\u6839\u76EE\u5F55\u9700\u8981\u6709\u4E00\u4E2A <code>manifest.json</code> \u6587\u6863\u4EE5\u63CF\u8FF0\u6269\u5C55\u7A0B\u5E8F\u76F8\u5173\u4FE1\u606F\u548C\u6743\u9650\uFF0C\u8FD8\u9700\u8981\u5728\u7EC8\u7AEF\u8F93\u5165\u4EE5\u4E0B\u547D\u4EE4\u5B89\u88C5\u4E00\u4E2A\u7279\u6B8A\u7684\u63D2\u4EF6 <a href="https://github.com/yeqisong/vite-plugin-vue-crx3" target="_blank" rel="noopener noreferrer">vite-plugin-vue-crx3</a></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">npm</span> i -D vite-plugin-vue-crx3
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>\u6839\u636E\u8BE5\u63D2\u4EF6\u7684<a href="https://github.com/yeqisong/vite-plugin-vue-crx3#2%E4%B8%80%E8%88%AC%E5%BC%80%E5%8F%91%E9%A1%B9%E7%9B%AE%E7%BB%93%E6%9E%84" target="_blank" rel="noopener noreferrer">\u8BF4\u660E\u6587\u6863</a>\uFF0C\u4FEE\u6539\u9879\u76EE\u7684\u76EE\u5F55\u7ED3\u6784\uFF0C\u4EE5\u7B26\u5408\u6269\u5C55\u7A0B\u5E8F\u5F00\u53D1\u8981\u6C42\u3002</p><blockquote><p>\u672C\u63D2\u4EF6\u7684\u6838\u5FC3\u5C31\u662F\uFF1A\u5C31\u4EE5 manifest.json \u4F5C\u4E3A\u5165\u53E3\u6587\u4EF6\uFF0C\u81EA\u52A8\u5206\u6790 manifest \u4E2D\u7684\u5F00\u53D1\u914D\u7F6E\uFF0C\u83B7\u53D6 vue \u5E94\u7528\u7684\u5404\u4E2A\u5165\u53E3\u6587\u4EF6\uFF0C\u6253\u5305\u65F6\u81EA\u52A8\u5C06 manifest.json \u4E2D\u5F00\u53D1\u8DEF\u5F84\u66F4\u65B0\u4E3A\u751F\u4EA7\u8DEF\u5F84\u3002</p></blockquote><p>\u9879\u76EE\u539F\u6765\u7684\u76EE\u5F55\u7ED3\u6784</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>\u2502  .eslintrc.js
\u2502  .gitignore
\u2502  index.html
\u2502  package-lock.json      
\u2502  package.json
\u2502  README.md
\u2502  vite.config.js
\u2502
\u251C\u2500.vscode
\u2502      extensions.json
\u2502      settings.json
\u2502
\u251C\u2500public
\u2502      favicon.ico
\u2502
\u2514\u2500src
    \u2502  App.vue
    \u2502  main.js
    \u2502
    \u251C\u2500assets
    \u2502      logo.png
    \u2502
    \u2514\u2500components
            HelloWorld.vue
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><p>\u7531\u4E8E\u9879\u76EE\u6253\u5305\u7684\u5165\u53E3\u6587\u4EF6\u662F <code>manifest.json</code>\uFF0C\u6240\u4EE5\u5220\u9664\u539F\u6765\u7684\u5165\u53E3\u6587\u4EF6 <code>src/main.js</code> \u4EE5\u53CA\u76F8\u5E94\u76F8\u5E94\u7684\u6587\u4EF6 <code>index.html</code>\u3002\u7136\u540E\u65B0\u589E <code>src/manifest.json</code> \u6587\u6863\u548C\u5176\u4ED6\u6587\u4EF6\u3002\u4FEE\u6539\u540E\u7684\u76EE\u5F55\u7ED3\u6784</p><p>\u{1F4A1} \u53C2\u8003 <a href="https://github.com/yeqisong/crx3-dev-template" target="_blank" rel="noopener noreferrer">crx3-dev-template</a> \u6A21\u677F</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>\u2502  .eslintrc.js       
\u2502  .gitignore
\u2502  package-lock.json  
\u2502  package.json       
\u2502  postcss.config.js  
\u2502  README.md
\u2502  tailwind.config.js 
\u2502  vite.config.js     
\u2502  
\u251C\u2500.vscode
\u2502      extensions.json
\u2502      settings.json  
\u2502      
\u251C\u2500public
\u2502  \u2502  favicon.ico     
\u2502  \u2502  
\u2502  \u2514\u2500_locales
\u2502      \u2514\u2500en
\u2514\u2500src
    \u2502  manifest.json  
    \u2502  options.html   
    \u2502  popup.html     
    \u2502  
    \u251C\u2500assets
    \u2502  \u2502  logo.png    
    \u2502  \u2502  
    \u2502  \u2514\u2500images       
    \u2502          icon128.png
    \u2502          icon16.png 
    \u2502          icon24.png 
    \u2502          icon32.png 
    \u2502          icon48.png 
    \u2502          icon64.png 
    \u2502          icon72.png 
    \u2502          logo.png   
    \u2502
    \u251C\u2500background
    \u2502      main.js        
    \u2502      
    \u251C\u2500options
    \u2502      App.vue        
    \u2502      main.js        
    \u2502      
    \u2514\u2500popup
            App.vue       
            main.js  
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br></div></div><p>\u4E3B\u8981\u7684\u6587\u4EF6\u548C\u6587\u4EF6\u5939\u4F5C\u7528\uFF1A</p><ul><li><code>src/manifest.json</code> \u6269\u5C55\u7A0B\u5E8F\u7684\u914D\u7F6E\u6E05\u5355</li><li><code>background</code> \u4E0E\u6269\u5C55\u7A0B\u5E8F\u7684\u540E\u53F0 service worker \u76F8\u5173\u7684\u4EE3\u7801\uFF0C\u5728 manifest V3 \u7248\u672C\u7684\u6269\u5C55\u7A0B\u5E8F\u4E2D\uFF0C\u540E\u53F0\u6CA1\u6709\u53EF\u89C6\u7684\u524D\u7AEF\u9875\u9762\uFF0C\u6240\u4EE5\u8BE5\u4E0D\u4F1A\u4E0D\u9700\u8981\u4F7F\u7528 Vue</li><li><code>src/popup.html</code> \u5F39\u51FA\u7A97\u7684\u5165\u53E3\u6587\u4EF6\uFF0C\u{1F4C1} \u6587\u4EF6\u5939 <code>popup</code> \u653E\u7F6E\u5F39\u7A97\u9875\u9762\u7684\u76F8\u5173\u4EE3\u7801\u6587\u6863\uFF0C\u8FD9\u662F\u4E00\u4E2A\u72EC\u7ACB\u7684 Vue \u5355\u9875\u9762\u5E94\u7528</li><li><code>src/options.html</code> \u8BBE\u7F6E\u9875\u9762\u7684\u5165\u53E3\u6587\u4EF6\uFF0C\u{1F4C1} \u6587\u4EF6\u5939 <code>options</code> \u653E\u7F6E\u8BBE\u7F6E\u9875\u9762\u7684\u76F8\u5173\u4EE3\u7801\u6587\u6863\uFF0C\u8FD9\u662F\u4E00\u4E2A\u72EC\u7ACB\u7684 Vue \u5355\u9875\u9762\u5E94\u7528</li><li>\u{1F4C1} \u6587\u4EF6\u5939 <code>public/_locales</code> \u653E\u7F6E\u4E0E\u56FD\u9645\u5316\uFF08\u7FFB\u8BD1\uFF09\u76F8\u5173\u7684\u6587\u6863</li></ul><p>\u5176\u4E2D\u5728 \u{1F4C1} \u6587\u4EF6\u5939 <code>src</code> \u4E2D\u7684 <code>manifest.json</code> \u6587\u6863\u662F\u6269\u5C55\u7A0B\u5E8F\u7684\u914D\u7F6E\u6E05\u5355</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;TagDown&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;manifest_version&quot;</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
    <span class="token property">&quot;version&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1.0.0&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;description&quot;</span><span class="token operator">:</span> <span class="token string">&quot;TagDown is a bookmark manager.&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;background&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;service_worker&quot;</span><span class="token operator">:</span> <span class="token string">&quot;./background/main.js&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;module&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;action&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;default_title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;TagDown&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;default_popup&quot;</span><span class="token operator">:</span> <span class="token string">&quot;./popup.html&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;default_icon&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;16&quot;</span><span class="token operator">:</span> <span class="token string">&quot;./assets/images/icon16.png&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;32&quot;</span><span class="token operator">:</span> <span class="token string">&quot;./assets/images/icon32.png&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;48&quot;</span><span class="token operator">:</span> <span class="token string">&quot;./assets/images/icon48.png&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;64&quot;</span><span class="token operator">:</span> <span class="token string">&quot;./assets/images/icon64.png&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;128&quot;</span><span class="token operator">:</span> <span class="token string">&quot;./assets/images/icon128.png&quot;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;options_page&quot;</span><span class="token operator">:</span> <span class="token string">&quot;./options.html&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;icons&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;16&quot;</span><span class="token operator">:</span> <span class="token string">&quot;./assets/images/icon16.png&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;32&quot;</span><span class="token operator">:</span> <span class="token string">&quot;./assets/images/icon32.png&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;48&quot;</span><span class="token operator">:</span> <span class="token string">&quot;./assets/images/icon48.png&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;64&quot;</span><span class="token operator">:</span> <span class="token string">&quot;./assets/images/icon64.png&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;128&quot;</span><span class="token operator">:</span> <span class="token string">&quot;./assets/images/icon128.png&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;default_locale&quot;</span><span class="token operator">:</span> <span class="token string">&quot;en&quot;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div></div><p>\u{1F4A1} \u7531\u4E8E\u653E\u5728 \u{1F4C1} \u6587\u4EF6\u5939 <code>src</code> \u4E0B\u7684 <code>manifest.json</code> \u53EA\u670D\u52A1\u4E8E\u5F00\u53D1\u73AF\u5883\uFF0C\u56E0\u6B64\u5728\u8BBE\u7F6E\u8D44\u6E90\uFF08\u5404\u4E2A\u5165\u53E3\u6587\u4EF6\uFF09\u7684\u8DEF\u5F84\u65F6\uFF0C\u4F7F\u7528\u76F8\u5BF9\u8DEF\u5F84\u5373\u53EF\uFF0C\u63D2\u4EF6\u6253\u5305\u65F6\u4F1A\u81EA\u52A8\u5206\u6790\u5E76\u66F4\u65B0\u8DEF\u5F84\u3002</p><p>\u8FD8\u8981\u5728 vite \u914D\u7F6E\u6587\u4EF6 <code>vite.config.js</code> \u5F15\u7528\u63D2\u4EF6\uFF0C\u5E76\u8BBE\u7F6E\u5165\u53E3\u6587\u4EF6</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> defineConfig <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;vite&#39;</span>
<span class="token keyword">import</span> vue <span class="token keyword">from</span> <span class="token string">&#39;@vitejs/plugin-vue&#39;</span>
<span class="token keyword">import</span> vue <span class="token keyword">from</span> <span class="token string">&#39;@vitejs/plugin-vue&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> crx3 <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;vite-plugin-vue-crx3&#39;</span><span class="token punctuation">;</span>

<span class="token comment">// https://vitejs.dev/config/</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineConfig</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  resolve<span class="token operator">:</span> <span class="token punctuation">{</span>
    alias<span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token string">&#39;@&#39;</span><span class="token operator">:</span> <span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;src&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token function">vue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">crx3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// crx3\u5373\u4E3A\u63D2\u4EF6\u5165\u53E3\u51FD\u6570</span>
  build<span class="token operator">:</span> <span class="token punctuation">{</span>
    target<span class="token operator">:</span> <span class="token string">&#39;es2015&#39;</span><span class="token punctuation">,</span>
    rollupOptions<span class="token operator">:</span> <span class="token punctuation">{</span>
      input<span class="token operator">:</span> <span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;src/manifest.json&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// \u5C06 src \u4E2D\u7684 manifest.json \u4F5C\u4E3A\u5165\u53E3\u6587\u4EF6</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p>\u8BE5\u63D2\u4EF6\u652F\u6301<strong>\u70ED\u91CD\u8F7D</strong>\u4FBF\u4E8E\u5F00\u53D1\u8C03\u8BD5\uFF0C\u9700\u8981\u5728 <code>package.json</code> \u6587\u6863\u4E2D\u6DFB\u52A0\u76F8\u5E94\u7684\u6307\u4EE4</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
  <span class="token property">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;dev&quot;</span><span class="token operator">:</span> <span class="token string">&quot;vite&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;build&quot;</span><span class="token operator">:</span> <span class="token string">&quot;vite build&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;serve&quot;</span><span class="token operator">:</span> <span class="token string">&quot;vite preview&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;watch&quot;</span><span class="token operator">:</span> <span class="token string">&quot;vite build --watch&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre><div class="highlight-lines"><br><br><br><br><br><br><div class="highlight-line">\xA0</div><br><br><br></div><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>\u7136\u540E\u5728\u5F00\u53D1\u65F6\u4F7F\u7528 <code>npm run watch</code> \u547D\u4EE4\u5373\u53EF\u542F\u7528\u70ED\u91CD\u8F7D\u529F\u80FD\uFF0C\u5F53\u4EE3\u7801\u7684\u4FEE\u6539\u4FDD\u5B58\u540E\uFF0C\u6D4F\u89C8\u5668\u81EA\u52A8\u66F4\u65B0\u5F53\u524D\u5F00\u53D1\u7684\u63D2\u4EF6\uFF0C\u6B63\u5728\u8C03\u7528\u7684\u7F51\u9875\u4E5F\u4F1A\u81EA\u52A8\u5237\u65B0\u3002</p><p>\u6700\u540E\u4E3A\u4E86\u4FBF\u4E8E\u7F51\u9875\u7684\u6837\u5F0F\u8BBE\u7F6E\uFF0C\u4F7F\u7528 <a href="https://tailwindcss.com/docs/guides/vue-3-vite" target="_blank" rel="noopener noreferrer">Tailwindcss \u6846\u67B6</a>\uFF0C\u6309\u7167\u5B98\u65B9\u6587\u6863\u7684\u4F9D\u6B64\u6267\u884C\u4EE5\u4E0B\u6B65\u9AA4\uFF1A</p><ul><li><p>\u5728\u7EC8\u7AEF\u4F7F\u7528\u4EE5\u4E0B\u547D\u4EE4\u5B89\u88C5 Tailwind CSS \u6A21\u5757\u548C\u76F8\u5E94\u7684\u4F9D\u8D56\u5305</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> -D tailwindcss@latest postcss@latest autoprefixer@latest
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div></li><li><p>\u5728\u7EC8\u7AEF\u4F7F\u7528\u4EE5\u4E0B\u547D\u4EE4\u521D\u59CB\u5316 Tailwind CSS \u751F\u6210\u4E00\u4E2A\u914D\u7F6E\u6587\u4EF6 <code>tailwind.config.js</code></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>npx tailwindcss init -p
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>\u4E3A\u4E86\u4F18\u5316\u9879\u76EE<a href="https://tailwindcss.com/docs/just-in-time-mode#enabling-jit-mode" target="_blank" rel="noopener noreferrer">\u5F00\u53D1</a>\u548C<a href="https://tailwindcss.com/docs/optimizing-for-production" target="_blank" rel="noopener noreferrer">\u6253\u5305</a>\u65F6\u7684\u6587\u4EF6\u5927\u5C0F\uFF0C\u9700\u8981\u5728\u914D\u7F6E\u6587\u4EF6 <code>tailwind.config.js</code> \u4E2D\u8FDB\u884C\u8BBE\u7F6E\uFF0C\u4EE5\u5220\u9664\u672A\u4F7F\u7528\u7684\u6837\u5F0F\u4EE3\u7801</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
  mode<span class="token operator">:</span> <span class="token string">&#39;jit&#39;</span><span class="token punctuation">,</span>
  purge<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;./src/**/*.{vue,js,ts,jsx,tsx}&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div></li></ul><p>\u{1F4A1} vite \u4F1A\u901A\u8FC7<a href="https://cn.vitejs.dev/guide/dep-pre-bundling.html" target="_blank" rel="noopener noreferrer">\u4F9D\u8D56\u9884\u6784\u5EFA</a>\u5B9E\u73B0 CommonJS \u548C UMD \u517C\u5BB9\u6027\uFF0C\u4F46\u5E76\u4E0D\u80FD\u89E3\u51B3\u6240\u6709\u95EE\u9898\uFF0C\u5728\u9879\u76EE\u4E2D\u4F7F\u7528 <strong><a href="https://github.com/perry-mitchell/webdav-client" target="_blank" rel="noopener noreferrer">webdav-client</a></strong> \u6A21\u5757\u5C31\u9047\u5230\u7F16\u8BD1\u95EE\u9898\uFF0C\u56E0\u6B64\u5F15\u5165\u4E00\u4E2A rollup \u63D2\u4EF6 <a href="https://github.com/rollup/plugins/tree/master/packages/commonjs/" target="_blank" rel="noopener noreferrer">@rollup/plugin-commonjs</a>\uFF0C\u5B83\u5C06 CommonJS \u6A21\u5757\u8F6C\u6362\u4E3A ES6 \u6A21\u5757</p><ul><li><p>\u5728\u7EC8\u7AEF\u4F7F\u7528\u4EE5\u4E0B\u547D\u4EE4\u5B89\u88C5\u6A21\u5757\u548C\u76F8\u5E94\u7684\u4F9D\u8D56\u5305</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> @rollup/plugin-commonjs --save-dev
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div></li><li><p>\u5728 vite \u914D\u7F6E\u6587\u4EF6 <code>vite.config.js</code> \u5F15\u7528\u63D2\u4EF6</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// ...</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineConfig</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token function">commonjs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">vue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">crx3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> 
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div></li></ul><h2 id="\u5F39\u51FA\u9875\u9762\u5F00\u53D1" tabindex="-1"><a class="header-anchor" href="#\u5F39\u51FA\u9875\u9762\u5F00\u53D1" aria-hidden="true">#</a> \u5F39\u51FA\u9875\u9762\u5F00\u53D1</h2><p>\u5728\u8FDB\u884C\u5F39\u51FA\u9875\u9762\u5F00\u53D1\u4E2D\uFF0C\u4E3B\u8981\u9700\u8981\u89E3\u51B3\u7684\u662F Vue <strong>\u7EC4\u4EF6\u95F4\u6570\u636E\u4F20\u9012</strong>\u95EE\u9898\u3002</p><p>\u4E3A\u4E86\u4FBF\u4E8E\u4EE3\u7801\u7684\u590D\u7528\u548C\u7EF4\u62A4\uFF0C\u5C06\u9875\u9762\u5206\u4E3A\u591A\u4E2A Vue \u7EC4\u4EF6\uFF0C\u4F8B\u5982\u5728\u5F39\u51FA\u9875\u9762\u7684\u6D4F\u89C8\u72B6\u6001\u4E2D\uFF0C\u5C06\u7F51\u9875\u7684\u7236\u7EA7\u7EC4\u4EF6 <code>BrowserPage</code> \u4E2D\u4E3B\u8981\u6709 4 \u5927\u5B50\u7EC4\u4EF6\uFF1A</p><ul><li><code>BrowserHeader.vue</code></li><li><code>BrowserMenu.vue</code> \u548C <code>BrowserMenuPin.vue</code></li><li><code>BrowserGrid.vue</code> \u548C <code>BrowserTree.vue</code>\uFF0C\u4EE5\u53CA <code>BrowserPin.vue</code></li><li><code>BrowserFooter</code></li></ul><p><img src="`+t+`" alt="components"></p><h3 id="\u7236\u5B50\u7EC4\u4EF6\u95F4\u6570\u636E\u4F20\u9012" tabindex="-1"><a class="header-anchor" href="#\u7236\u5B50\u7EC4\u4EF6\u95F4\u6570\u636E\u4F20\u9012" aria-hidden="true">#</a> \u7236\u5B50\u7EC4\u4EF6\u95F4\u6570\u636E\u4F20\u9012</h3><p>\u5728 Vue \u4E2D\u6700\u5E38\u89C1\u7684\u7EC4\u4EF6\u4E4B\u95F4\u7684\u6570\u636E\u4F20\u9012\u65B9\u5F0F\u662F\u4F7F\u7528 <code>prop</code> \u548C <code>emit</code> \u5B9E\u73B0\u7236\u5B50\u7EC4\u4EF6\u95F4\u4F20\u503C\uFF1A</p><ul><li>\u901A\u8FC7 prop \u5411\u5B50\u7EC4\u4EF6\u4F20\u9012\u6570\u636E\u3002prop \u662F\u5728\u7EC4\u4EF6\u4E0A\u6CE8\u518C\u7684\u4E00\u4E9B<strong>\u81EA\u5B9A\u4E49 attribute</strong>\u3002\u5F53\u4E00\u4E2A\u503C\u4F20\u9012\u7ED9\u4E00\u4E2A prop attribute \u7684\u65F6\u5019\uFF0C\u5B83\u5C31\u53D8\u6210\u4E86\u90A3\u4E2A\u7EC4\u4EF6\u5B9E\u4F8B\u7684\u4E00\u4E2A property\u3002</li><li>\u901A\u8FC7 emit \u5411\u7236\u7EC4\u4EF6\u4F20\u9012\u6570\u636E\u3002\u5F53\u7EC4\u4EF6\u9700\u8981\u4FEE\u6539\u7236\u5C42\u63A7\u7BA1\u7684\u6570\u636E\uFF08\u8FD9\u4E9B\u6570\u636E\u901A\u8FC7 props \u4F20\u9012\u8FDB\u6765\uFF09\u65F6\uFF0C\u57FA\u4E8E<strong>\u5355\u5411\u6570\u636E\u6D41\u539F\u5219</strong>\u4E0D\u80FD\u5728\u7EC4\u4EF6\u5185\u8FDB\u884C\u4FEE\u6539\uFF0C\u800C\u662F\u9700\u8981\u901A\u8FC7 <code>$emit(&#39;eventName&#39;, value)</code> <strong>\u5411\u5916\u629B\u51FA\u81EA\u5B9A\u4E49\u7684\u4E8B\u4EF6</strong>\uFF0C\u901A\u77E5\u7236\u5C42\u8FDB\u884C\u6570\u636E\u4FEE\u6539\u3002</li></ul><p>\u{1F4A1} \u5BF9\u4E8E\u8F93\u5165\u578B\u7684\u7EC4\u4EF6\uFF0C\u4F8B\u5982\u5728\u9879\u76EE\u4E2D\u7EC4\u4EF6 <code>BrowserFooter</code> \u5305\u542B\u4E00\u4E2A <code>&lt;input&gt;</code> \u5143\u7D20\uFF0C\u53EF\u4EE5\u5141\u8BB8\u7528\u6237\u8F93\u5165\u6807\u7B7E\u7EC4\u7684\u540D\u79F0\u3002\u53EF\u4EE5\u5728\u7EC4\u4EF6\u4E0A\u4F7F\u7528 <code>v-model</code>\uFF0C\u4EE5\u5728\u7236\u5B50\u7EC4\u4EF6\u4F20\u503C\u7684\u540C\u65F6\u5B9E\u73B0\u6570\u636E\u7684\u53CC\u5411\u7ED1\u5B9A\uFF0C\u5373\u6570\u636E\u53EF\u4EE5\u4ECE\u7236\u5C42\u4F20\u9012\u7ED9\u5B50\u7EC4\u4EF6\uFF08\u4E00\u822C\u4F5C\u4E3A\u53D8\u91CF\u7684\u521D\u59CB\u503C\uFF09\uFF0C\u540C\u65F6\u53EF\u4EE5\u63A5\u6536\u5B50\u7EC4\u4EF6\u8FD4\u56DE\u7684\u503C\uFF0C\u4EE5\u4FEE\u6539\u7ED1\u5B9A\u7684\u53D8\u91CF\u3002</p><p>\u5728\u7236\u5C42\u4F7F\u7528\u7EC4\u4EF6\u65F6\uFF0C\u901A\u8FC7 <code>v-model</code> \u5B9E\u73B0\u6570\u636E\u7684\u53CC\u5411\u7ED1\u5B9A\u3002</p><div class="language-vue ext-vue line-numbers-mode"><pre class="language-vue"><code><span class="token comment">&lt;!-- \u4F7F\u7528\u7EC4\u4EF6\uFF0C\u4E3A\u4E86\u7B80\u6D01\u7684\u6F14\u793A\uFF0C\u7701\u7565\u663E\u793A\u5176\u4ED6\u5C5E\u6027\u7684\u7ED1\u5B9A --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>BrowserFooter</span>
  <span class="token attr-name"><span class="token namespace">v-model:</span>multi-on-group</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>multiOnGroup<span class="token punctuation">&quot;</span></span>
  <span class="token attr-name"><span class="token namespace">v-model:</span>new-group-name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>newGroupName<span class="token punctuation">&quot;</span></span>
<span class="token punctuation">/&gt;</span></span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>\u5728\u5B50\u7EC4\u4EF6\u7684\u8868\u5355\u5143\u7D20\u4E2D\uFF0C\u7ED1\u5B9A\u76F8\u5E94\u7684\u5C5E\u6027\uFF0C\u540C\u65F6\u76D1\u542C\u76F8\u5E94\u7684\u4E8B\u4EF6\uFF1A</p><ul><li><p>\u5BF9\u4E8E <code>&lt;input type=&quot;checkbox&quot;&gt;</code> \u590D\u9009\u6846\uFF0C\u7ED1\u5B9A\u7684\u5C5E\u6027\u662F <code>checked</code>\uFF0C\u9700\u8981\u76D1\u542C\u7684\u4E8B\u4EF6\u662F <code>change</code></p></li><li><p>\u5BF9\u4E8E <code>&lt;input type=&quot;text&quot;&gt;</code> \u6587\u672C\u8F93\u5165\u6846\uFF0C\u7ED1\u5B9A\u7684\u5C5E\u6027\u662F <code>value</code>\uFF0C\u9700\u8981\u76D1\u542C\u7684\u4E8B\u4EF6\u662F <code>input</code></p></li></ul><p>\u5F53\u5C5E\u6027\u503C\u53D8\u66F4\u65F6\uFF0C\u9700\u8981\u629B\u51FA\u4E8B\u4EF6\u7684\u683C\u5F0F\u4EE5 <code>update:</code> \u4E3A\u524D\u7F00\uFF0C\u800C\u5C5E\u6027\u503C\u901A\u8FC7\u8BFB\u53D6\u4E8B\u4EF6\u5BF9\u8C61\u7684\u76F8\u5E94\u5C5E\u6027 <code>$event.target</code> \u83B7\u5F97</p><div class="language-vue ext-vue line-numbers-mode"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token comment">&lt;!-- \u7701\u7565\u5176\u4ED6\u6A21\u677F\u5185\u5BB9 --&gt;</span>
  <span class="token comment">&lt;!-- \u5355\u4E2A\u590D\u9009\u6846 --&gt;</span>
  <span class="token comment">&lt;!-- \u4E3A\u4E86\u7B80\u6D01\u7684\u6F14\u793A\uFF0C\u7701\u7565\u663E\u793A\u5176\u4ED6\u5C5E\u6027\u7684\u7ED1\u5B9A --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span>
    <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>group<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>checkbox<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name">:checked</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>multiOnGroup<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name">@change</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>$emit(<span class="token punctuation">&#39;</span>update:multiOnGroup<span class="token punctuation">&#39;</span>, $event.target.checked)<span class="token punctuation">&quot;</span></span>
  <span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span>
    <span class="token attr-name">for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>group<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text-xs text-gray-500<span class="token punctuation">&quot;</span></span>
  <span class="token punctuation">&gt;</span></span>\u5728\u7EC4\u5185\u6253\u5F00<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">&gt;</span></span>

  <span class="token comment">&lt;!-- \u7701\u7565\u5176\u4ED6\u6A21\u677F\u5185\u5BB9 --&gt;</span>
  <span class="token comment">&lt;!-- \u6587\u672C\u8F93\u5165\u6846 --&gt;</span>
  <span class="token comment">&lt;!-- \u4E3A\u4E86\u7B80\u6D01\u7684\u6F14\u793A\uFF0C\u7701\u7565\u663E\u793A\u5176\u4ED6\u5C5E\u6027\u7684\u7ED1\u5B9A --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span>
    <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>\u8F93\u5165 group \u540D\u79F0<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name">:value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>newGroupName<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name">@input</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>$emit(<span class="token punctuation">&#39;</span>update:newGroupName<span class="token punctuation">&#39;</span>, $event.target.value)<span class="token punctuation">&quot;</span></span>
  <span class="token punctuation">&gt;</span></span>
  <span class="token comment">&lt;!-- \u7701\u7565\u5176\u4ED6\u6A21\u677F\u5185\u5BB9 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  props<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
    multiOnGroup<span class="token operator">:</span> Boolean<span class="token punctuation">,</span>
    newGroupName<span class="token operator">:</span> <span class="token punctuation">{</span>
      type<span class="token operator">:</span> String<span class="token punctuation">,</span>
      <span class="token keyword">default</span><span class="token operator">:</span> <span class="token string">&#39;new&#39;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  emits<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token comment">// ...</span>
    <span class="token string">&#39;update:multiOnGroup&#39;</span><span class="token punctuation">,</span>
    <span class="token string">&#39;update:newGroupName&#39;</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br></div></div><h3 id="\u7956\u5B59\u7EC4\u4EF6\u95F4\u6570\u636E\u4F20\u9012" tabindex="-1"><a class="header-anchor" href="#\u7956\u5B59\u7EC4\u4EF6\u95F4\u6570\u636E\u4F20\u9012" aria-hidden="true">#</a> \u7956\u5B59\u7EC4\u4EF6\u95F4\u6570\u636E\u4F20\u9012</h3><p>\u7528 <code>provide</code> \u548C <code>inject</code> \u5B9E\u73B0\u4ECE\u7956\u5148\u7EC4\u4EF6\u5411\u5176\u5B50\u5B59\u540E\u4EE3\u7EC4\u4EF6\u4F20\u503C\uFF1A</p><ul><li>\u7236\u7EC4\u4EF6\u7528 <code>provide</code> \u9009\u9879\u6216\uFF08\u5728\u7EC4\u5408\u5F0F API \u4E2D\uFF09\u65B9\u6CD5\u6765\u63D0\u4F9B\u6570\u636E\uFF0C\u53EF\u4EE5\u63D0\u4F9B\u54CD\u5E94\u5F0F\u6570\u636E\uFF0C\u4F8B\u5982 ref \u5BF9\u8C61</li><li>\u5B50\u7EC4\u4EF6\u7528 <code>inject</code> \u9009\u9879\u6216\uFF08\u5728\u7EC4\u5408\u5F0F API \u4E2D\uFF09\u65B9\u6CD5\u6765\u63A5\u6536\u8FD9\u4E2A\u6570\u636E</li></ul><p>\u5728\u9879\u76EE\u4E2D\u591A\u4E2A\u7EC4\u4EF6\u4E2D\u90FD\u9700\u8981\u4F7F\u7528 IndexedDB \u6570\u636E\u5E93\uFF0C\u5728\u5F39\u51FA\u9875\u7684 Vue \u5165\u53E3\u6587\u4EF6 <code>src/popup/main.js</code> \u4E2D\u4F7F\u7528\u6846\u67B6 Dexie.js \u521B\u5EFA\u4E00\u4E2A\u6570\u636E\u5E93\u5B9E\u4F8B\uFF0C\u518D\u901A\u8FC7 <code>provide</code> \u7684\u65B9\u5F0F\u4F9B\u5176\u4ED6\u5B50\u7EC4\u4EF6\u4F7F\u7528\u3002</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">import</span> Dexie <span class="token keyword">from</span> <span class="token string">&#39;dexie&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> createApp <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;vue&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> App <span class="token keyword">from</span> <span class="token string">&#39;./App.vue&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string">&#39;@/styles/tailwind.css&#39;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">createApp</span><span class="token punctuation">(</span>App<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> db <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Dexie</span><span class="token punctuation">(</span><span class="token string">&#39;tagdown&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
db<span class="token punctuation">.</span><span class="token function">version</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">stores</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  bookmark<span class="token operator">:</span> <span class="token string">&#39;id, *tags, *groups&#39;</span><span class="token punctuation">,</span>
  share<span class="token operator">:</span> <span class="token string">&#39;id, share&#39;</span><span class="token punctuation">,</span>
  star<span class="token operator">:</span> <span class="token string">&#39;id, star&#39;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
db<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">database</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  app<span class="token punctuation">.</span><span class="token function">provide</span><span class="token punctuation">(</span><span class="token string">&#39;db&#39;</span><span class="token punctuation">,</span> database<span class="token punctuation">)</span><span class="token punctuation">;</span>
  app<span class="token punctuation">.</span><span class="token function">mount</span><span class="token punctuation">(</span><span class="token string">&#39;#app&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// Error occurred</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p>\u7136\u540E\u5728\u7EC4\u4EF6\uFF0C\u4F8B\u5982 <code>BrowserPage.vue</code> \u4E2D\u901A\u8FC7 <code> const db = inject(&#39;db&#39;);</code> \u6765\u63A5\u6536\u8BE5\u6570\u636E\u5E93\u5B9E\u4F8B\u3002</p><p>\u{1F4A1} \u4E3A\u4E86\u4FBF\u4E8E\u4EE3\u7801\u7EF4\u62A4\uFF0C\u5F53\u4F7F\u7528\u54CD\u5E94\u5F0F provide / inject \u503C\u65F6\uFF0C\u5EFA\u8BAE\u5C3D\u53EF\u80FD\u5C06<strong>\u5BF9\u54CD\u5E94\u5F0F property \u7684\u4FEE\u6539\u9650\u5236\u5728\u5B9A\u4E49 provide \u7684\u7EC4\u4EF6\u5185</strong>\u3002\u5982\u679C\u771F\u7684\u9700\u8981\u5728\u6CE8\u5165\u6570\u636E\u7684\u7EC4\u4EF6\u5185\u90E8\u66F4\u65B0 inject \u7684\u6570\u636E\uFF0C\u5EFA\u8BAE\u540C\u65F6 provide \u4E00\u4E2A<strong>\u65B9\u6CD5</strong>\u6765\u8D1F\u8D23\u6539\u53D8\u503C\uFF0C\u8FD9\u6837\u53EF\u4EE5\u5C06\u6570\u636E\u503C\u7684\u8BBE\u5B9A\u548C\u6570\u636E\u4FEE\u6539\u7684\u903B\u8F91\u4EE3\u7801\u90FD\u4F9D\u7136\u96C6\u4E2D\u653E\u5728\u7956\u7236\u7EC4\u4EF6\u4E2D\uFF0C\u4FBF\u4E8E\u540E\u7EED\u8DDF\u8E2A\u548C\u7EF4\u62A4\u3002</p><p>\u5728\u7956\u5148\u7EC4\u4EF6 <code>src/popup/App.vue</code> \u4E2D\u6839\u636E\u54CD\u5E94\u5F0F\u53D8\u91CF <code>Page</code> \u63A7\u5236\u5F39\u51FA\u9875\u9762\u7684\u72B6\u6001\u662F <code>&quot;browser&quot;</code> \u8FD8\u662F <code>&quot;edit&quot;</code>\uFF0C\u800C\u63A7\u5236\u8BE5\u53D8\u91CF\u5207\u6362\u7684\u6309\u94AE\u662F\u5728\u540E\u4EE3\u7EC4\u4EF6 <code>BrowserFooter.vue</code> \u4E2D.</p><p>\u56E0\u6B64\u5728\u7956\u5148\u7EC4\u4EF6\u63D0\u4F9B\u4FEE\u6539\u8BE5\u53D8\u91CF\u7684\u65B9\u6CD5</p><div class="language-vue ext-vue line-numbers-mode"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> <span class="token punctuation">{</span> ref<span class="token punctuation">,</span> provide <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;vue&#39;</span><span class="token punctuation">;</span>
<span class="token comment">// ...</span>
    
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
  <span class="token comment">// provide page state and change the page state function</span>
  <span class="token function">provide</span><span class="token punctuation">(</span><span class="token string">&#39;page&#39;</span><span class="token punctuation">,</span> page<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token function-variable function">changePage</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    page<span class="token punctuation">.</span>value <span class="token operator">=</span> value<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token function">provide</span><span class="token punctuation">(</span><span class="token string">&#39;changePage&#39;</span><span class="token punctuation">,</span> changePage<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>\u5728\u540E\u4EE3\u7EC4\u4EF6\u63A5\u6536\u8BE5\u65B9\u6CD5\uFF0C\u5E76\u7ED1\u5B9A\u5230\u6309\u94AE\u4E0A</p><div class="language-vue ext-vue line-numbers-mode"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token comment">&lt;!-- \u7701\u7565\u5176\u4ED6\u6A21\u677F\u4EE3\u7801 --&gt;</span>
  <span class="token comment">&lt;!-- \u4E3A\u4E86\u7B80\u6D01\u7684\u6F14\u793A\uFF0C\u7701\u7565\u663E\u793A\u5176\u4ED6\u5C5E\u6027\u7684\u7ED1\u5B9A --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span>
    <span class="token attr-name">title</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>add bookmark<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>changePage(<span class="token punctuation">&#39;</span>edit<span class="token punctuation">&#39;</span>)<span class="token punctuation">&quot;</span></span>
  <span class="token punctuation">&gt;</span></span>
  <span class="token comment">&lt;!-- \u7701\u7565\u5176\u4ED6\u6A21\u677F\u4EE3\u7801 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> <span class="token punctuation">{</span> ref<span class="token punctuation">,</span> watch<span class="token punctuation">,</span> inject <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;vue&#39;</span><span class="token punctuation">;</span>
<span class="token comment">// ...</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
  <span class="token keyword">const</span> changePage <span class="token operator">=</span> <span class="token function">inject</span><span class="token punctuation">(</span><span class="token string">&#39;changePage&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token comment">// ...</span>

  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
    changePage
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><h3 id="\u5144\u5F1F\u7EC4\u4EF6\u95F4\u4FE1\u606F\u4F20\u9012" tabindex="-1"><a class="header-anchor" href="#\u5144\u5F1F\u7EC4\u4EF6\u95F4\u4FE1\u606F\u4F20\u9012" aria-hidden="true">#</a> \u5144\u5F1F\u7EC4\u4EF6\u95F4\u4FE1\u606F\u4F20\u9012</h3><p>\u5BF9\u4E8E\u5728\u5C42\u7EA7\u7ED3\u6784\u4E2D\u5904\u4E8E\u300C\u5E73\u884C\u300D\u5173\u7CFB\uFF0C\u5982\u679C\u9700\u8981\u8FDB\u884C\u6570\u636E\u4F20\u9012\uFF0C\u53EF\u4EE5\u8003\u8651\u4F7F\u7528 Vue \u5B98\u65B9\u63A8\u8350\u7684\u6570\u636E\u72B6\u6001\u7BA1\u7406\u63D2\u4EF6 <a href="https://vuex.vuejs.org/zh/" target="_blank" rel="noopener noreferrer">Vuex</a>\u3002</p><p>\u5728\u9879\u76EE\u4E2D\u6709\u4E00\u4E2A\u9700\u6C42\u662F\u901A\u8FC7\u70B9\u51FB\u7EC4\u4EF6 <code>BrowserMenu</code> \u7684\u6309\u94AE\uFF0C\u63A7\u5236\u5144\u5F1F\u7EC4\u4EF6 <code>BrowserGrid</code> \u7684\u6587\u4EF6\u5939\u5C55\u5F00/\u6298\u53E0\u3002</p><p><img src="`+o+`" alt="toggle folder"></p><p>\u628A\u5144\u5F1F\u7EC4\u4EF6\u7684\u7236\u7EC4\u4EF6\u4F5C\u4E3A\u4FE1\u606F\u4F20\u9012\u7684\u300C\u6865\u6881\u300D\uFF0C\u5728\u7236\u7EC4\u4EF6\u76D1\u542C\u5176\u4E2D\u4E00\u4E2A\u5B50\u7EC4\u4EF6\u629B\u51FA\u7684\u4E8B\u4EF6\uFF0C\u7136\u540E\u63A5\u6536\u5230\u81EA\u5B9A\u4E49\u4E8B\u4EF6\u65F6\uFF0C\u901A\u8FC7\u6A21\u677F\u5F15\u7528\u6765\u8C03\u7528\u53E6\u4E00\u4E2A\u5B50\u7EC4\u4EF6\u7684\u65B9\u6CD5\uFF0C\u4ECE\u800C\u5B9E\u73B0\u5144\u5F1F\u7EC4\u4EF6\u4FE1\u606F\u4F20\u9012\u3002</p><p>\u5C06\u7236\u7EC4\u4EF6 <code>BrowserPage</code> \u4F5C\u4E3A\u300C\u6865\u6881\u300D\uFF0C\u8FDE\u63A5\u4E24\u4E2A\u300C\u5E73\u884C\u300D\u5173\u7CFB\u5B50\u7EC4\u4EF6\u3002</p><div class="language-vue ext-vue line-numbers-mode"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token comment">&lt;!-- \u7701\u7565\u5176\u4ED6\u6A21\u677F\u4EE3\u7801 --&gt;</span>
  <span class="token comment">&lt;!-- menu --&gt;</span>
  <span class="token comment">&lt;!-- \u4E3A\u4E86\u7B80\u6D01\u7684\u6F14\u793A\uFF0C\u7701\u7565\u663E\u793A\u5176\u4ED6\u5C5E\u6027\u7684\u7ED1\u5B9A --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>component</span>
      <span class="token attr-name">:is</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>browserMenuComponent<span class="token punctuation">&quot;</span></span>
      <span class="token attr-name">@unfold-all</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>unfoldAllHandler<span class="token punctuation">&quot;</span></span>
      <span class="token attr-name">@fold-all</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>foldAllHandler<span class="token punctuation">&quot;</span></span>
    <span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token comment">&lt;!-- \u7701\u7565\u5176\u4ED6\u6A21\u677F\u4EE3\u7801 --&gt;</span>
  <span class="token comment">&lt;!-- \u4E3A\u4E86\u7B80\u6D01\u7684\u6F14\u793A\uFF0C\u7701\u7565\u663E\u793A\u5176\u4ED6\u5C5E\u6027\u7684\u7ED1\u5B9A --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>BrowserGrid</span>
    <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>grid<span class="token punctuation">&quot;</span></span>
  <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> <span class="token punctuation">{</span>
  ref<span class="token punctuation">,</span> computed<span class="token punctuation">,</span> watch<span class="token punctuation">,</span> inject<span class="token punctuation">,</span>
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;vue&#39;</span><span class="token punctuation">;</span>
    
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
  <span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// unfold or fold all folder</span>
    <span class="token keyword">const</span> grid <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// \u5F15\u7528 BrowserGrid \u7EC4\u4EF6</span>
    <span class="token keyword">const</span> <span class="token function-variable function">unfoldAllHandler</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token comment">// ...</span>
      grid<span class="token punctuation">.</span>value<span class="token punctuation">.</span><span class="token function">unfoldAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// \u8C03\u7528\u7EC4\u4EF6\u4E2D\u7684\u65B9\u6CD5 unfoldAll()</span>
      <span class="token comment">// ...</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token keyword">const</span> <span class="token function-variable function">foldAllHandler</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token comment">// ...</span>
      grid<span class="token punctuation">.</span>value<span class="token punctuation">.</span><span class="token function">foldAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// \u8C03\u7528\u7EC4\u4EF6\u4E2D\u7684\u65B9\u6CD5 foldAll()</span>
      <span class="token comment">// ...</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>   

    <span class="token comment">// ...</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      <span class="token comment">// ...</span>
      grid<span class="token punctuation">,</span>
      unfoldAllHandler<span class="token punctuation">,</span>
      foldAllHandler<span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br></div></div><h3 id="\u9875\u9762\u6837\u5F0F" tabindex="-1"><a class="header-anchor" href="#\u9875\u9762\u6837\u5F0F" aria-hidden="true">#</a> \u9875\u9762\u6837\u5F0F</h3><p>\u7531\u4E8E Chrome <a href="https://developer.chrome.com/docs/extensions/reference/action/#popup" target="_blank" rel="noopener noreferrer">\u9650\u5236</a>\u5F39\u51FA\u9875\u9762\u7684\u5927\u5C0F\uFF0C\u9AD8\u548C\u5BBD\u7684\u6700\u5C0F\u503C\u90FD\u662F\u662F 25px\uFF0C\u9AD8\u7684\u6700\u5927\u503C\u662F 600px\uFF0C\u5BBD\u7684\u6700\u5927\u503C\u662F 800px\u3002\u56E0\u6B64\u4E3A\u4E86\u5C3D\u53EF\u80FD\u5229\u7528\u7A7A\u95F4\u663E\u793A\u5185\u5BB9\uFF0CTagDown \u5C06\u5F39\u51FA\u9875\u7684\u6D4F\u89C8\u72B6\u6001\u8BBE\u7F6E\u4E3A\u6700\u5927\u9650\u5236</p><div class="language-vue ext-vue line-numbers-mode"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>scss<span class="token punctuation">&quot;</span></span> <span class="token attr-name">scoped</span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
<span class="token selector">// src/popup/App.vue
.browser-mode</span> <span class="token punctuation">{</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 800px<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 600px<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
    
// ...
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>\u4F46\u662F\u6B64\u65F6\u5F39\u51FA\u9875\u5C31\u4F1A\u51FA\u73B0<strong>\u6EDA\u52A8\u6761</strong>\uFF0C\u53EF\u4EE5\u5728\u5F39\u51FA\u9875\u7684\u5165\u53E3\u6587\u4EF6 \u{1F4C4} <code>src/popup.html</code> \u4E2D\u4E3A <code>&lt;body&gt;</code> \u5143\u7D20\u6DFB\u52A0\u6837\u5F0F\uFF0C\u53D6\u6D88\u5B83\u7684\u6EDA\u52A8\u6761</p><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>en<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
  <span class="token comment">&lt;!-- \u7701\u7565\u90E8\u5206\u4EE3\u7801 --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
    <span class="token selector">body::-webkit-scrollbar</span> <span class="token punctuation">{</span>
      <span class="token property">width</span><span class="token punctuation">:</span> 0px<span class="token punctuation">;</span>
      <span class="token property">height</span><span class="token punctuation">:</span> 0px<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>  
    
<span class="token comment">&lt;!-- \u7701\u7565\u90E8\u5206\u4EE3\u7801 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h2 id="\u6570\u636E\u6301\u4E45\u5316" tabindex="-1"><a class="header-anchor" href="#\u6570\u636E\u6301\u4E45\u5316" aria-hidden="true">#</a> \u6570\u636E\u6301\u4E45\u5316</h2><p>\u53C2\u8003\uFF1A</p><ul><li>\u300A\u73B0\u4EE3 JavaScript \u6559\u7A0B\u300B<a href="https://zh.javascript.info/indexeddb" target="_blank" rel="noopener noreferrer">IndexedDB</a> \u4E00\u7AE0</li><li><a href="https://golb.hplar.ch/2017/09/A-closer-look-at-IndexedDB.html" target="_blank" rel="noopener noreferrer">A closer look at IndexedDB</a></li></ul><h3 id="indexeddb-\u57FA\u7840" tabindex="-1"><a class="header-anchor" href="#indexeddb-\u57FA\u7840" aria-hidden="true">#</a> IndexedDB \u57FA\u7840</h3><p>\u524D\u7AEF\u6570\u636E\u6301\u4E45\u5316\u6709\u591A\u79CD\u65B9\u5F0F\u5B9E\u73B0\uFF0C\u5176\u4E2D\u8F83\u5E38\u7528\u7684\u662F\u901A\u8FC7\u6D4F\u89C8\u5668\u81EA\u5E26\u7684 IndexedDB \u6570\u636E\u5E93\u5B9E\u73B0\u3002</p><p>\u{1F4A1} \u7531\u4E8E\u6269\u5C55\u7A0B\u5E8F\u7684\u540E\u53F0 service worker \u7531\u4E8E Service workers \u65E0\u6CD5\u8BBF\u95EE DOM \u548C\u76F8\u5173\u7684 API\uFF0C\u4E14\u73AF\u5883\u4E2D\u6CA1\u6709 <code>window</code> \u8FD9\u4E2A\u53D8\u91CF\u5BF9\u8C61\uFF0C\u6240\u4EE5\u65E0\u6CD5\u4F7F\u7528\u6D4F\u89C8\u5668\u63D0\u4F9B\u7684 <code>localStorage</code> \u548C <code>sessionStorage</code> \u8FDB\u884C\u6570\u636E\u5B58\u50A8\u3002Chrome \u4E3A\u6269\u5C55\u7A0B\u5E8F\u63D0\u4F9B\u4E00\u4E2A<a href="https://developer.chrome.com/docs/extensions/reference/storage/" target="_blank" rel="noopener noreferrer">\u6570\u636E\u5B58\u50A8 API <code>chrome.storeage</code></a> \uFF0C\u8BE5 API \u53EF\u4EE5\u5B9E\u73B0 \u7C7B\u4F3C localStorage \u7684\u529F\u80FD\uFF0C\u7528\u4E8E\u5B58\u50A8<strong>\u5C11\u91CF</strong>\u7684\u6570\u636E\uFF08\u4E00\u822C\u662F\u5B58\u50A8\u6269\u5C55\u7A0B\u5E8F\u7684\u8BBE\u7F6E\u53C2\u6570\uFF09\u3002\u5BF9\u4E8E <a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.chrome.com%2Fdocs%2Fextensions%2Freference%2Fstorage%2F%23property-sync" target="_blank" rel="noopener noreferrer">sync \u540C\u6B65\u5B58\u50A8</a>\u7684\u6570\u636E\uFF0C\u5141\u8BB8\u603B\u5927\u5C0F\u4E3A 100KB\uFF1B\u5BF9\u4E8E <a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.chrome.com%2Fdocs%2Fextensions%2Freference%2Fstorage%2F%23property-local" target="_blank" rel="noopener noreferrer">local \u672C\u5730\u5B58\u50A8</a>\u7684\u6570\u636E\uFF0C\u5141\u8BB8\u603B\u5927\u5C0F\u4E3A 5MB\uFF08\u7C7B\u4F3C\u4E8E localstorage \u7684\u5B58\u50A8\u9650\u5236\uFF09\u3002</p><p>IndexedDB \u5177\u6709\u4EE5\u4E0B\u7279\u70B9\uFF1A</p><ul><li>\u901A\u8FC7\u652F\u6301\u591A\u79CD\u7C7B\u578B\u7684\u952E\uFF0C\u6765\u5B58\u50A8\u51E0\u4E4E\u53EF\u4EE5\u662F<strong>\u4EFB\u4F55\u7C7B\u578B</strong>\u7684\u503C</li><li>\u652F\u6491\u4E8B\u52A1\uFF0C\u6709\u826F\u597D\u7684\u53EF\u9760\u6027\uFF08<strong>\u4E8B\u52A1</strong>\u662F\u6570\u636E\u5E93\u901A\u7528\u672F\u8BED\uFF0C\u662F\u6307\u4E00\u7EC4\u64CD\u4F5C\u8981\u4E48\u5168\u90E8\u6210\u529F\uFF0C\u8981\u4E48\u5168\u90E8\u5931\u8D25\uFF0C\u4E0D\u5B58\u5728\u4E2D\u95F4\u7ED3\u679C\u4ECE\u800C\u5BFC\u81F4\u6570\u636E\u51B2\u7A81\u6216\u4E0D\u5B8C\u6574\uFF09</li><li>\u652F\u6301\u952E\u7684\u8303\u56F4\u67E5\u8BE2\uFF0C\u4E5F\u652F\u6301\u4E3A\u6570\u636E\u6DFB\u52A0\u7D22\u5F15</li></ul><p>\u26A0\uFE0F IndexedDB \u9075\u5FAA<strong>\u540C\u6E90\u7B56\u7565</strong>\u9650\u5236\uFF0C\u5373\u6BCF\u4E2A\u6570\u636E\u5E93\u90FD\u662F\u7ED1\u5B9A\u5230\u6E90\uFF08\u57DF/\u534F\u8BAE/\u7AEF\u53E3\uFF09\u7684\uFF0C\u4E0D\u540C\u7684\u7F51\u7AD9\u4E0D\u80FD\u76F8\u4E92\u8BBF\u95EE\u5BF9\u65B9\u7684\u6570\u636E\u5E93\u3002</p><p>IndexedDB \u6570\u636E\u6709\u51E0\u4E2A\u57FA\u672C\u7684\u6982\u5FF5\uFF0C\u548C SQL\u3001NoSQL \u7B49\u5E38\u7528\u6570\u636E\u5E93\u6982\u5FF5\u7C7B\u4F3C\uFF1A</p><ul><li>\uFF08\u540C\u6E90\uFF09\u7F51\u9875\u53EF\u4EE5\u521B\u5EFA\u4E00\u4E2A\u4E13\u5C5E\u7684\u6570\u636E\u5E93 Database\uFF08\u9075\u5FAA\u540C\u6E90\u7B56\u7565\u7684\u9650\u5236\uFF09</li><li>\u6BCF\u4E00\u4E2A\u6570\u636E\u5E93\u53EF\u4EE5\u521B\u5EFA\u591A\u4E2A<strong>\u5BF9\u8C61\u5E93 ObjectStore</strong>\uFF0C\u548C SQL \u7684\u8868\u683C\u6982\u5FF5\u7C7B\u4F3C</li><li>\u5728\u5BF9\u8C61\u5E93\u4E2D\u5C31\u662F\u4EE5\u952E\u503C\u5BF9\u7684\u5F62\u5F0F\u5B58\u50A8\u7740\u7684\u4E00\u6761\u6761\u6570\u636E</li></ul><p><img src="`+c+`" alt="IndexedDB"></p><p>\u4F7F\u7528 IndexedDB \u7684\u57FA\u672C\u6D41\u7A0B\u5982\u4E0B\uFF1A</p><ul><li>\u521B\u5EFA/\u6253\u5F00\u4E00\u4E2A\u6570\u636E\u5E93</li><li>\u5B9A\u4E49\u6570\u636E\u7ED3\u6784\uFF0C\u521B\u5EFA<strong>\u5BF9\u8C61\u5E93</strong>\uFF0C\u6307\u5B9A\u6570\u636E\u9879\u7684\u952E key\uFF08\u8FD8\u53EF\u4EE5\u521B\u5EFA\u7D22\u5F15 index\uFF09</li><li>\u542F\u52A8<strong>\u4E8B\u52A1</strong>\u5BF9\u5BF9\u6570\u636E\u8FDB\u884C\u64CD\u4F5C</li><li>\u76D1\u542C\u76F8\u5E94\u7684\u4E8B\u4EF6</li><li>\u83B7\u53D6\u64CD\u4F5C\u7ED3\u679C</li></ul><p>\u4F7F\u7528\u65B9\u6CD5 <code>open()</code>\uFF08\u8FDE\u63A5\uFF09\u4E00\u4E2A\u6570\u636E\u5E93\uFF0C\u7B2C\u4E00\u4E2A\u53C2\u6570 <code>name</code> \u662F\u6570\u636E\u5E93\u540D\u79F0\uFF0C\u6570\u636E\u5E93\u53EF\u4EE5\u6709\u8BB8\u591A\u4E0D\u540C\u7684\u540D\u79F0\uFF1B\u7B2C\u4E8C\u4E2A\u53C2\u6570\u662F\u4E00\u4E2A\u6B63\u6574\u6570\uFF0C\u8868\u793A\u6570\u636E\u5E93\u7248\u672C\uFF0C\u9ED8\u8BA4\u4E3A <code>1</code>\u3002</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">let</span> openRequest <span class="token operator">=</span> indexedDB<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> version<span class="token punctuation">)</span><span class="token punctuation">;</span> 
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>\u8BE5\u65B9\u6CD5\u8FD4\u56DE <code>openRequest</code> \u5BF9\u8C61\uFF0C\u6211\u4EEC\u9700\u8981\u76D1\u542C\u8BE5\u5BF9\u8C61\u4E0A\u7684\u4E8B\u4EF6\uFF08\u56E0\u4E3A\u5BF9 IndexedDB APIs \u4E00\u822C\u90FD\u662F<strong>\u5F02\u6B65\u64CD\u4F5C</strong>\uFF0C\u5F85\u4E8B\u4EF6\u89E6\u53D1\u540E\u624D\u53EF\u4EE5\u5728\u56DE\u8C03\u51FD\u6570\u4E2D\u6267\u884C\u540E\u7EED\u64CD\u4F5C\uFF09\uFF1A</p><ul><li><code>success</code>\uFF1A\u6570\u636E\u5E93\u51C6\u5907\u5C31\u7EEA\u65F6\u89E6\u53D1\u7684\u4E8B\u4EF6\u3002\u7136\u540E\u5728 <code>openRequest.result</code> \u4E2D\u6709\u4E86\u4E00\u4E2A\u6570\u636E\u5E93\u5BF9\u8C61 Database Object\uFF0C\u4F7F\u7528\u5B83\u5BF9\u6570\u636E\u5E93\u8FDB\u884C\u8FDB\u4E00\u6B65\u7684\u8C03\u7528</li><li><code>error</code>\uFF1A\u6253\u5F00\u5931\u8D25\u65F6\u89E6\u53D1\u7684\u4E8B\u4EF6</li><li><code>upgradeneeded</code>\uFF1A\u6570\u636E\u5E93\u5DF2\u51C6\u5907\u5C31\u7EEA\uFF0C\u4F46\u5176\u7248\u672C\u5DF2\u8FC7\u65F6\u89E6\u53D1\u7684\u4E8B\u4EF6\u3002\u53EF\u4EE5\u6839\u636E\u9700\u8981\u6BD4\u8F83\u7248\u672C\uFF0C\u5E76\u5347\u7EA7\u6570\u636E\u7ED3\u6784\u3002\u5347\u7EA7\u64CD\u4F5C\u987A\u5229\u5B8C\u6210\u540E\uFF0C<strong><code>onsuccess</code> \u4E8B\u4EF6\u88AB\u89E6\u53D1\uFF0C\u6570\u636E\u5E93\u624D\u7B97\u662F\u6210\u529F\u6253\u5F00\u4E86</strong>\u3002</li></ul><p>\u{1F4A1} \u5982\u679C\u6570\u636E\u5E93\u8FD8\u4E0D\u5B58\u5728\u65F6\uFF08\u4ECE\u6B64\u65F6\u6570\u636E\u5E93\u7684\u7248\u672C\u662F <code>0</code>\uFF09\uFF0C\u6253\u5F00\u6570\u636E\u5E93\u64CD\u4F5C\u5C31\u4F1A\u89E6\u53D1 <code>upgradeneeded</code> \u4E8B\u4EF6\uFF0C\u6B64\u65F6\u53EF\u4EE5\u6267\u884C\u521D\u59CB\u5316\uFF08\u5982\u521B\u5EFA\u5BF9\u8C61\u5E93\uFF0C\u6307\u5B9A\u6570\u636E\u9879\u7684\u952E key\uFF0C\u5B9A\u4E49\u6570\u636E\u9879\u7684\u7D22\u5F15 index \u7B49\uFF09</p><p>\u26A0\uFE0F \u53EA\u6709\u5728 <code>upgradeneeded</code> \u4E8B\u4EF6\u7684\u56DE\u8C03\u51FD\u6570\u4E2D\uFF0C\u624D\u53EF\u4EE5\u66F4\u65B0\u5347\u7EA7\u6570\u636E\u5E93\u7684\u7ED3\u6784\uFF08\u4F8B\u5982\u5BF9\u8C61\u5E93\u7684\u521B\u5EFA\uFF0C\u4EE5\u53CA\u4FEE\u6539\u5BF9\u8C61\u5E93\u7684\u7D22\u5F15\u5C5E\u6027\uFF09</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">let</span> openRequest <span class="token operator">=</span> indexedDB<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">&quot;tagdown&quot;</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// \u5982\u679C\u6D4F\u89C8\u5668\u4E2D\u6CA1\u6709\u8BE5\u6570\u636E\u5E93\uFF08\u6216\u5DF2\u5B58\u5728\u7684\u6570\u636E\u5E93\u7248\u672C\uFF0C\u4E0E\u6253\u5F00\u7684\u7248\u672C\u4E0D\u7B26\uFF09\uFF0C\u5219\u4F1A\u89E6\u53D1 upgradeneeded \u4E8B\u4EF6</span>
openRequest<span class="token punctuation">.</span><span class="token function-variable function">onupgradeneeded</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// \u6267\u884C\u521D\u59CB\u5316</span>
  <span class="token keyword">let</span> bookmark <span class="token operator">=</span> db<span class="token punctuation">.</span><span class="token function">createObjectStore</span><span class="token punctuation">(</span><span class="token string">&#39;bookmark&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> keyPath<span class="token operator">:</span> <span class="token string">&quot;id&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> index <span class="token operator">=</span> bookmark<span class="token punctuation">.</span><span class="token function">createIndex</span><span class="token punctuation">(</span><span class="token string">&#39;tags&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;tags&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> multiEntry<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment">// \u53C2\u6570\u4F9D\u6B64\u8868\u793A\uFF1A\u7D22\u5F15\u540D\u79F0\u4E3A tags\uFF0C\u5BF9\u5E94\u4EE5\u6570\u636E\u7684\u54EA\u4E00\u4E2A\u5C5E\u6027\u4F5C\u4E3A\u7D22\u5F15\u503C\uFF0C\u7531\u4E8E\u8BE5\u5C5E\u6027\u503C\u4E3A\u6570\u7EC4\uFF0C\u4E14\u5C06\u6570\u7EC4\u7684\u6BCF\u4E2A\u5143\u7D20\u4F5C\u4E3A\u7D22\u5F15\u65F6\u9700\u8981\u914D\u7F6E multiEntry \u4E3A true</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// \u5982\u679C\u6D4F\u89C8\u5668\u4E2D\u6709\u8BE5\u6570\u636E\u5E93\uFF0C\u5219\u4F1A\u89E6\u53D1 onsuccess \u4E8B\u4EF6</span>
openRequest<span class="token punctuation">.</span><span class="token function-variable function">onsuccess</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> db <span class="token operator">=</span> openRequest<span class="token punctuation">.</span>result<span class="token punctuation">;</span>
  <span class="token comment">// \u7EE7\u7EED\u4F7F\u7528\u5DF2\u6709\u7684 db \u5BF9\u8C61\u5904\u7406\u6570\u636E\u5E93</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

openRequest<span class="token punctuation">.</span><span class="token function-variable function">onerror</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">&quot;Error&quot;</span><span class="token punctuation">,</span> openRequest<span class="token punctuation">.</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>\u{1F4A1} \u5982\u679C\u60F3\u5220\u9664\u6574\u4E2A\u6570\u636E\u5E93\uFF08\u800C\u4E0D\u662F\u5355\u4E00\u6761\u6570\u636E\uFF09\uFF0C\u53EF\u4EE5\u4F7F\u7528\u65B9\u6CD5 <code>deleteDatabase(databaseName)</code></p><p>\u63A5\u7740\uFF0C<strong><mark>\u5728 <code>success</code> \u4E8B\u4EF6\u7684\u56DE\u8C03\u51FD\u6570\u4E2D</mark></strong>\uFF0C\u4F7F\u7528\u65B9\u6CD5 <code>transaction</code> \u542F\u52A8\u4E8B\u52A1\uFF0C\u5BF9\u6570\u636E\u8FDB\u884C\u64CD\u4F5C\u3002</p><p>\u4F7F\u7528\u4E8B\u52A1\u64CD\u4F5C\u6570\u636E\u7684\u57FA\u672C\u6D41\u7A0B\u5982\u4E0B\uFF1A</p><ul><li><p>\u4F7F\u7528 <code>db.transaction(store)</code> \u521B\u5EFA\u4E00\u4E2A\u4E8B\u52A1\uFF0C\u8868\u660E\u8981\u8BBF\u95EE\u7684\u5BF9\u8C61\u5E93</p></li><li><p>\u4F7F\u7528 <code>transaction.objectStore(name)</code> \u83B7\u53D6\u5B58\u50A8\u5BF9\u8C61</p></li><li><p>\u53D1\u8D77\u8BF7\u6C42\uFF0C\u64CD\u4F5C\u6570\u636E</p></li><li><p>\u76D1\u542C\u8BF7\u6C42\u7684\u6210\u529F/\u9519\u8BEF\u4E8B\u4EF6\uFF0C\u5E76\u6267\u884C\u76F8\u5E94\u7684\u64CD\u4F5C</p></li></ul><p>\u65B9\u6CD5 <code>transaction</code> \u521B\u5EFA\u4E00\u4E2A\u4E8B\u52A1\uFF0C\u5B83\u63A5\u6536\u7684\u7B2C\u4E00\u4E2A\u53C2\u6570\u662F\u4E8B\u52A1\u8981\u8BBF\u95EE\u7684\u5BF9\u8C61\u5E93\u540D\u79F0\uFF08\u5982\u679C\u6211\u4EEC\u8981\u8BBF\u95EE\u591A\u4E2A\u5BF9\u8C61\u5E93\uFF0C\u5219\u8BE5\u53C2\u6570\u503C\u662F\u6291\u6076\u6570\u7EC4\uFF09\uFF1B\uFF08\u53EF\u9009\uFF09\u7B2C\u4E8C\u4E2A\u53C2\u6570\u662F\u4E8B\u52A1\u7C7B\u578B\uFF1A</p><ul><li><code>readonly</code> \u53EA\u8BFB\uFF0C\u9ED8\u8BA4\u503C</li><li><code>readwrite</code> \u53EF\u8BFB\u53D6\u548C\u5199\u5165\u6570\u636E\uFF08\u4F46\u4E0D\u80FD\u521B\u5EFA/\u5220\u9664/\u66F4\u6539\u7684\u5BF9\u8C61\u5E93\uFF0C\u8FD9\u7C7B\u64CD\u4F5C\u53EA\u80FD\u5728 <code>upgradeneeded</code> \u4E8B\u4EF6\u7684\u56DE\u8C03\u51FD\u6570\u4E2D\u8FDB\u884C\uFF09</li></ul><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>db<span class="token punctuation">.</span><span class="token function">transaction</span><span class="token punctuation">(</span>store<span class="token punctuation">[</span><span class="token punctuation">,</span> type<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>\u{1F4A1} \u9700\u8981\u4E24\u79CD\u4E8B\u52A1\u7C7B\u578B\uFF0C\u662F\u56E0\u4E3A\u4E24\u79CD\u7C7B\u578B\u7684\u4E8B\u7269\u64CD\u4F5C\u300C\u6027\u80FD\u300D\u662F\u4E0D\u540C\u7684\u3002\u8BB8\u591A <code>readonly</code> \u4E8B\u52A1\u80FD\u591F\u540C\u65F6\u8BBF\u95EE\u540C\u4E00\u5B58\u50A8\u533A\uFF1B\u4F46 <code>readwrite</code> \u4E8B\u52A1\u4E0D\u80FD\u3002\u56E0\u4E3A <code>readwrite</code> \u4E8B\u52A1\u4F1A\u300C<strong>\u9501\u5B9A</strong>\u300D\u5B58\u50A8\u533A\u8FDB\u884C\u5199\u64CD\u4F5C\uFF0C\u4E0B\u4E00\u4E2A\u4E8B\u52A1\u5FC5\u987B\u7B49\u5F85\u524D\u4E00\u4E2A\u4E8B\u52A1\u5B8C\u6210\uFF0C\u624D\u80FD\u8BBF\u95EE\u76F8\u540C\u7684\u5B58\u50A8\u533A\u3002</p><p>\u521B\u5EFA\u4E8B\u52A1\u540E\uFF0C\u4F7F\u7528\u4E8B\u52A1\u5B9E\u4F8B\u7684\u65B9\u6CD5 <code>objectStore(name)</code> \u83B7\u53D6\u76F8\u5E94\u7684\u5BF9\u8C61\u5E93\uFF0C\u7136\u540E\u5C31\u53EF\u4EE5\u5BF9\u91CC\u9762\u7684\u6570\u636E\u9879\u8FDB\u884C\u64CD\u4F5C\u3002\u5BF9\u8C61\u5E93\u652F\u6301\u4E24\u79CD\u5B58\u50A8\u503C\u7684\u65B9\u6CD5\uFF1A</p><ul><li>\u65B9\u6CD5 <code>put(value, [key])</code> \u5C06 <code>value</code> \u6DFB\u52A0\u5230\u5B58\u50A8\u533A\u3002<strong>\u5982\u679C\u5DF2\u7ECF\u5B58\u5728\u76F8\u540C\u952E\u7684\u6570\u636E\uFF0C\u5219\u5C06\u66FF\u6362\u8BE5\u503C\u3002</strong></li><li>\u65B9\u6CD5 <code>add(value, [key])</code> \u4E0E\u65B9\u6CD5 <code>put</code> \u7C7B\u4F3C\uFF0C<strong>\u4F46\u662F\u5982\u679C\u5DF2\u7ECF\u5B58\u5728\u76F8\u540C\u952E\u7684\u6570\u636E\uFF0C\u5219\u8BF7\u6C42\u5931\u8D25</strong>\uFF0C\u5E76\u751F\u6210\u4E00\u4E2A\u540D\u4E3A <code>&quot;ConstraInterror&quot;</code> \u7684\u9519\u8BEF\u3002</li></ul><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">let</span> transaction <span class="token operator">=</span> db<span class="token punctuation">.</span><span class="token function">transaction</span><span class="token punctuation">(</span><span class="token string">&quot;bookmark&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;readwrite&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// \u521B\u5EFA\u4E00\u4E2A\u4E8B\u52A1\uFF0C\u8868\u660E\u8981\u8BBF\u95EE\u7684\u5BF9\u8C61\u5E93\u662F bookmark\uFF0C\u4E8B\u52A1\u7C7B\u578B\u662F\u8BFB\u5199</span>

<span class="token comment">// \u83B7\u53D6\u5BF9\u8C61\u5E93\u8FDB\u884C\u64CD\u4F5C</span>
<span class="token keyword">let</span> bookmark <span class="token operator">=</span> transaction<span class="token punctuation">.</span><span class="token function">objectStore</span><span class="token punctuation">(</span><span class="token string">&quot;bookmark&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// \u6570\u636E\u9879</span>
<span class="token keyword">let</span> node <span class="token operator">=</span> <span class="token punctuation">{</span>
  id<span class="token operator">:</span> <span class="token string">&#39;123&#39;</span><span class="token punctuation">,</span>
  title<span class="token operator">:</span> <span class="token string">&#39;Google&#39;</span>
  url<span class="token operator">:</span> <span class="token string">&#39;www.google.com&#39;</span>
  tags<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;search&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;tool&#39;</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> request <span class="token operator">=</span> bookmark<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>node<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// \u5411\u5BF9\u8C61\u5E93\u4E2D\u6DFB\u52A0\u6570\u636E\u9879</span>

<span class="token comment">// \u76D1\u542C\u8BF7\u6C42\u6210\u529F\u4E8B\u4EF6</span>
request<span class="token punctuation">.</span><span class="token function-variable function">onsuccess</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;Bookmark added to the store&quot;</span><span class="token punctuation">,</span> request<span class="token punctuation">.</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// \u76D1\u542C\u8BF7\u6C42\u5931\u8D25\u4E8B\u4EF6</span>
request<span class="token punctuation">.</span><span class="token function-variable function">onerror</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;Error&quot;</span><span class="token punctuation">,</span> request<span class="token punctuation">.</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><p>\u5220\u9664\u7279\u5B9A\u7684\u6570\u636E\u9700\u8981\u6307\u5B9A\u67E5\u8BE2\u6761\u4EF6\uFF0C\u4F7F\u7528\u65B9\u6CD5 <code>delete(query)</code></p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// \u5220\u9664\u952E\u503C\u6EE1\u8DB3 id=&#39;123&#39; \u7684\u6570\u636E</span>
bookmark<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token string">&#39;123&#39;</span><span class="token punctuation">)</span>\uFF1B
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>\u6570\u636E\u5E93\u53E6\u4E00\u4E2A\u91CD\u8981\u529F\u80FD\u662F\u641C\u7D22\u6570\u636E\uFF0CIndexedDB \u652F\u6301\u4E24\u79CD\u4E3B\u8981\u7684\u641C\u7D22\u7C7B\u578B\uFF1A</p><ul><li>\u57FA\u4E8E\u4E00\u4E2A\u952E\u6216\u8303\u56F4\u8FDB\u884C\u641C\u7D22</li><li>\u57FA\u4E8E\u4E00\u4E2A\u7D22\u5F15\u6216\u8303\u56F4\u8FDB\u884C\u641C\u7D22</li></ul><p>\u4E24\u8005\u7684\u533A\u522B\u662F\uFF1A\u7531\u4E8E\u6BCF\u4E2A\u6570\u636E\u7684\u952E key \u662F\u7279\u6B8A\u552F\u4E00\u7684\uFF0C\u5982\u679C\u57FA\u4E8E\u5355\u4E00\u503C\u641C\u7D22\uFF0C\u6700\u591A\u83B7\u5F97\u4E00\u4E2A\u6570\u636E\u9879\uFF1B\u800C\u7D22\u5F15\u503C\u53EF\u4EE5\u590D\u7528\uFF0C\u5982\u679C\u57FA\u4E8E\u5355\u4E00\u7D22\u5F15\u503C\u641C\u7D22\uFF0C\u53EF\u4EE5\u83B7\u5F97\u591A\u4E2A\u6570\u636E\u9879\u3002</p><p>\u4F7F\u7528\u65B9\u6CD5 <code>get(query)</code> \u6309\u952E key \u641C\u7D22\u6570\u636E\uFF0C\u8FD4\u56DE\u6EE1\u8DB3\u6761\u4EF6\u7684\u6570\u636E\u9879\uFF1B\u4F7F\u7528\u65B9\u6CD5 <code>getKey(query)</code> \u6309\u952E key \u641C\u7D22\u6570\u636E\uFF0C\u4F46\u662F\u8FD4\u56DE\u7684\u662F\u6EE1\u8DB3\u6761\u4EF6\u7684\u6570\u636E\u9879\u7684\u952E\u503C</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>bookmark<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&#39;123&#39;</span><span class="token punctuation">)</span> <span class="token comment">// \u8FD4\u56DE\u6570\u636E\u9879</span>
bookmark<span class="token punctuation">.</span><span class="token function">getKey</span><span class="token punctuation">(</span><span class="token string">&#39;123&#39;</span><span class="token punctuation">)</span> <span class="token comment">// \u8FD4\u56DE 123</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>\u{1F4A1} \u4F7F\u7528\u65B9\u6CD5 <code>getAll([query], [count])</code> \u6216 <code>getAllKeys([query], [count])</code> \u83B7\u53D6\u4E00\u4E2A\u8303\u56F4\u7684\u6570\u636E\u6216\u952E\u503C\uFF0C\u8FD4\u56DE\u6570\u7EC4\uFF0C\u5176\u4E2D\u53C2\u6570 <code>query</code> \u8868\u793A\u4E00\u4E2A\u8303\u56F4\uFF0C\u9700\u8981\u901A\u8FC7\u8C03\u7528<a href="https://zh.javascript.info/indexeddb#:~:text=%E4%B8%80%E4%B8%AA%E2%80%9C%E9%94%AE%E8%8C%83%E5%9B%B4%E2%80%9D%E3%80%82-,%E4%BD%BF%E7%94%A8%E4%BB%A5%E4%B8%8B%E8%B0%83%E7%94%A8%E5%87%BD%E6%95%B0%E5%88%9B%E5%BB%BA%E8%8C%83%E5%9B%B4,-%EF%BC%9A" target="_blank" rel="noopener noreferrer">\u76F8\u5E94\u7684\u51FD\u6570</a>\u521B\u5EFA\u3002</p><p>\u{1F4A1} <strong>\u53EA\u8FD4\u56DE\u952E\u503C</strong>\u7684\u65B9\u6CD5\u6548\u7387\u66F4\u9AD8\uFF0C\u8BE5\u64CD\u4F5C\u4E0D\u9700\u8981\u89E3\u6790\u8BFB\u53D6\u5B8C\u6574\u7684\u6570\u636E</p><p><a href="https://zh.javascript.info/indexeddb#tong-guo-dai-suo-yin-de-zi-duan-sou-suo" target="_blank" rel="noopener noreferrer">\u901A\u8FC7\u7D22\u5F15 index \u8FDB\u884C\u67E5\u8BE2</a>\uFF0C\u4E5F\u662F\u4F7F\u7528\u76F8\u540C\u7684\u65B9\u6CD5\uFF0C\u4F46\u662F\u901A\u8FC7\u7D22\u5F15\u5BF9\u8C61\u8C03\u7528\u8FD9\u4E9B\u65B9\u6CD5\u3002</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">let</span> tagsIndex <span class="token operator">=</span> bookmark<span class="token punctuation">.</span><span class="token function">index</span><span class="token punctuation">(</span><span class="token string">&quot;tags&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// \u7D22\u5F15\u5BF9\u8C61</span>
tagsIndex<span class="token punctuation">.</span><span class="token function">getAll</span><span class="token punctuation">(</span><span class="token string">&#39;tool&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// \u83B7\u53D6\u6240\u6709\u6807\u8BB0\u6709 tool \u7684\u6570\u636E\u9879</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="dexie-js" tabindex="-1"><a class="header-anchor" href="#dexie-js" aria-hidden="true">#</a> Dexie.js</h3><p>\u867D\u7136 IndexedDB \u5927\u90E8\u5206\u64CD\u4F5C\u90FD\u662F\u5F02\u6B65\u7684\uFF0C\u4F46\u662F\u65B9\u6CD5\u8FD4\u56DE\u7684\u4E0D\u662F Promise\uFF0C\u800C\u662F\u57FA\u4E8E\u76D1\u542C\u4E8B\u4EF6\u6267\u884C\u56DE\u8C03\u7684\u65B9\u5F0F\u6765\u5904\u7406\u64CD\u4F5C\u7ED3\u679C\uFF0C\u5F00\u53D1\u7E41\u7410\u4E14\u4EE3\u7801\u4E0D\u6613\u4E8E\u7EF4\u62A4\u3002</p><p>\u4E3A\u4E86\u4FBF\u4E8E\u5F00\u53D1\u4F7F\u7528\u4E00\u4E2A\u540D\u4E3A <strong><a href="https://dexie.org/" target="_blank" rel="noopener noreferrer">Dexie.js</a> \u5E93\uFF0C\u5B83\u5BF9 IndexedDB APIs \u8FDB\u884C\u4E8C\u6B21\u5C01\u88C5</strong>\uFF0C\u8BA9\u8C03\u7528 IndexedDB \u66F4\u65B9\u4FBF\u3002\u8BE5\u5E93\u5927\u90E8\u5206\u65B9\u6CD5\u90FD\u662F\u5F02\u6B65\u4E14\u8FD4\u56DE Promise\u3002</p><p>\u4E0E IndexedDB \u7C7B\u4F3C\uFF0C\u5B83\u4E5F\u6709\u76F8\u5E94\u7684\u4E0D\u540C\u6982\u5FF5\uFF0C\u4E14\u4E0D\u540C\u7684\u7C7B\u5C01\u88C5\u4E86\u4E0D\u540C\u7684\u65B9\u6CD5</p><ul><li><code>Dexie</code> \u8BE5\u5E93\u7684\u6838\u5FC3\u7C7B\uFF0C\u901A\u8FC7\u8BE5\u7C7B\u5B9E\u4F8B\u5316\uFF0C\u53EF\u4EE5\u521B\u5EFA/\u8FDE\u63A5\u4E00\u4E2A IndexedDB \u6570\u636E\u5E93</li><li>Table \u8BE5\u7C7B\u8868\u793A\u5BF9\u8C61\u5E93 ObjectStore</li><li>Collection \u8BE5\u7C7B\u8868\u793A\u5BF9\u8C61\u5E93\u4E2D\u4E00\u90E8\u5206\u6570\u636E\u9879\uFF0C\u53EF\u4EE5\u7406\u89E3\u4E3A\u6570\u636E\u7684\u67E5\u8BE2\u7ED3\u679C</li></ul><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// src/</span>
<span class="token comment">// \u5B9E\u4F8B\u5316\u4E00\u4E2A\u6570\u636E\u5E93</span>
<span class="token keyword">const</span> db <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Dexie</span><span class="token punctuation">(</span><span class="token string">&#39;tagdown&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// \u58F0\u660E\u7248\u672C\u548C\u6570\u636E\u7ED3\u6784\uFF08\u5BF9\u8C61\u5E93\uFF09</span>
db<span class="token punctuation">.</span><span class="token function">version</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">stores</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token comment">// \u521B\u5EFA 3 \u4E2A\u5BF9\u8C61\u5E93\uFF0C\u952E\u4E3A\u5BF9\u8C61\u5E93\u7684\u540D\u79F0\uFF0C\u503C\u662F\u5BF9\u8C61\u5E93\u7684\u4E2D\u6570\u636E\u9879\u7684\u952E\u548C\u7D22\u5F15\uFF0C\u7528\u9017\u53F7\u5206\u9694</span>
  bookmark<span class="token operator">:</span> <span class="token string">&#39;id, *tags, *groups&#39;</span><span class="token punctuation">,</span> <span class="token comment">// \u7B2C\u4E00\u4E2A\u662F\u6307\u5B9A\u7528\u4F5C\u4E3A\u952E\u7684\u5C5E\u6027\uFF0C\u4E4B\u540E\u5C31\u662F\u7D22\u5F15</span>
  <span class="token comment">// \u52A0\u661F\u53F7 * \u8868\u793A\u6570\u636E\u76F8\u5E94\u5C5E\u6027\u503C\u4E3A\u6570\u7EC4\uFF0C\u4E14\u5C06\u6570\u7EC4\u7684\u6BCF\u4E2A\u5143\u7D20\u4F5C\u4E3A\u7D22\u5F15</span>
  share<span class="token operator">:</span> <span class="token string">&#39;id, share&#39;</span><span class="token punctuation">,</span>
  star<span class="token operator">:</span> <span class="token string">&#39;id, star&#39;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// \u6253\u5F00/\u521B\u5EFA\u6570\u636E\u5E93\uFF0C\u5F02\u6B65\u64CD\u4F5C</span>
db<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">database</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  app<span class="token punctuation">.</span><span class="token function">provide</span><span class="token punctuation">(</span><span class="token string">&#39;db&#39;</span><span class="token punctuation">,</span> database<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// \u901A\u8FC7 provide-inject \u7684\u65B9\u5F0F\u5C06\u6570\u636E\u5E93\u5BF9\u8C61\u63D0\u4F9B\u7ED9\u5E94\u7528\u4E2D\u5176\u4ED6\u7EC4\u4EF6\u4F7F\u7528</span>
  app<span class="token punctuation">.</span><span class="token function">mount</span><span class="token punctuation">(</span><span class="token string">&#39;#app&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// Error occurred</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>\u{1F4A1} \u6839\u636E\u5B98\u65B9\u7684<a href="https://dexie.org/docs/Dexie/Dexie.open()" target="_blank" rel="noopener noreferrer">\u64CD\u4F5C\u6307\u5357</a>\uFF0C<strong>\u4E0D\u5FC5</strong>\u5224\u65AD\u6D4F\u89C8\u5668\u4E2D\u662F\u5426\u6709\u5DF2\u6709\u540C\u540D\u7684\u6570\u636E\uFF0C\u56E0\u4E3A\u6BCF\u6B21\u5C1D\u8BD5\u8FDE\u63A5\u6570\u636E\u5E93\u65F6\uFF0CDexie \u4F1A\u81EA\u52A8\u5224\u65AD\uFF0C\u6309\u9700\u6253\u5F00\u5DF2\u6709\u6570\u636E\u5E93\u6216\u521B\u5EFA\u4E00\u4E2A\u65B0\u6570\u636E\u5E93\u3002</p><p>\u4EE5\u4E0B\u5217\u51FA\u5728\u9879\u76EE\u4E2D\u4E0E\u6570\u636E\u5E93\u76F8\u5173\u7684\u4E00\u4E9B\u4E3B\u8981\u65B9\u6CD5</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// src/composables/useBookmark.js</span>
<span class="token comment">// ...</span>
<span class="token keyword">const</span> db <span class="token operator">=</span> <span class="token function">inject</span><span class="token punctuation">(</span><span class="token string">&#39;db&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// \u57FA\u4E8E\u952E id \u67E5\u8BE2\u6570\u636E</span>
<span class="token keyword">const</span> <span class="token function-variable function">getBookmarkDB</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">id</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> bookmark <span class="token operator">=</span> <span class="token keyword">await</span> db<span class="token punctuation">.</span>bookmark<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> bookmark<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// \u5411 bookmark \u5BF9\u8C61\u5E93\u6DFB\u52A0\u6570\u636E</span>
<span class="token keyword">const</span> <span class="token function-variable function">setBookmarkDB</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">id<span class="token punctuation">,</span> bookmark</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// console.log(bookmark);</span>
  <span class="token keyword">await</span> db<span class="token punctuation">.</span>bookmark<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    id<span class="token punctuation">,</span>
    title<span class="token operator">:</span> bookmark<span class="token punctuation">.</span>title<span class="token punctuation">,</span>
    url<span class="token operator">:</span> bookmark<span class="token punctuation">.</span>url<span class="token punctuation">,</span>
    faviconUrl<span class="token operator">:</span> bookmark<span class="token punctuation">.</span>faviconUrl<span class="token punctuation">,</span>
    tags<span class="token operator">:</span> bookmark<span class="token punctuation">.</span>tags<span class="token punctuation">,</span>
    groups<span class="token operator">:</span> bookmark<span class="token punctuation">.</span>groups<span class="token punctuation">,</span>
    description<span class="token operator">:</span> bookmark<span class="token punctuation">.</span>description<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// \u57FA\u4E8E\u952E id \u5220\u9664\u6570\u636E</span>
<span class="token keyword">const</span> <span class="token function-variable function">deleteBookmarkDB</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">id</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">await</span> db<span class="token punctuation">.</span>bookmark<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div><p>\u83B7\u53D6\u7D22\u5F15\u7684\u6240\u6709\u503C</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// src/options/App.vue</span>
<span class="token comment">// ...</span>
<span class="token keyword">const</span> db <span class="token operator">=</span> <span class="token function">inject</span><span class="token punctuation">(</span><span class="token string">&#39;db&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">onMounted</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// \u83B7\u53D6\u6570\u636E\u5E93\u4E2D\u7D22\u5F15 tags \u7684\u6240\u6709\u53EF\u80FD\u7684\u503C</span>
  allTags<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token keyword">await</span> db<span class="token punctuation">.</span>bookmark<span class="token punctuation">.</span><span class="token function">orderBy</span><span class="token punctuation">(</span><span class="token string">&#39;tags&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">uniqueKeys</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>\u4F7F\u7528 <code>where</code> \u67E5\u8BE2\u8BED\u53E5</p><div class="language-vue ext-vue line-numbers-mode"><pre class="language-vue"><code>// src/options/App.vue
// ...
const db = inject(&#39;db&#39;);
// \u7B5B\u9009\u6761\u4EF6\u662F\u7D22\u5F15 share \u7684\u503C\u4E3A 1\uFF0C\u5E76\u8FD4\u56DE\u4E00\u4E2A\u7531\u8FD9\u4E9B\u6570\u636E\u7684\u952E\u503C\u6784\u6210\u7684\u6570\u7EC4
const getShareableIds = async () =&gt; {
  const result = await db.share.where(&#39;share&#39;).equals(1).primaryKeys();
  return result;
};
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>\u5C06\u67E5\u8BE2\u7ED3\u679C\u8F6C\u6362\u4E3A\u6570\u7EC4</p><div class="language-vue ext-vue line-numbers-mode"><pre class="language-vue"><code>// src/popup/components/BrowserPage.vue
// ...
const db = inject(&#39;db&#39;);
const starNodes = await db.star.where({ star: 1 }).toArray();
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>\u5BFC\u5165\u3001\u5BFC\u51FA IndexedDB \u6570\u636E\u5E93</p><div class="language-vue ext-vue line-numbers-mode"><pre class="language-vue"><code>// src/options/App.vue
// ...
import {
  importDB, exportDB, importInto, peakImportFile,
} from &#39;dexie-export-import&#39;;

// ...
// \u5BFC\u51FA\u6570\u636E\u5E93\u4E3A blob
blob = await exportDB(db, {
  prettyJson: true,
});

// ...
// \u5BFC\u5165\u6570\u636E\u5E93
await importInto(db, file, {
  overwriteValues: true,
}).then(() =&gt; {
  console.log(&#39;import database successful!&#39;);
}).catch((err) =&gt; {
  console.log(err);
});
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><h2 id="\u6570\u636E\u540C\u6B65" tabindex="-1"><a class="header-anchor" href="#\u6570\u636E\u540C\u6B65" aria-hidden="true">#</a> \u6570\u636E\u540C\u6B65</h2><p>\u5728\u6269\u5C55\u7A0B\u5E8F\u4E2D\u4F7F\u7528 <a href="https://www.bilibili.com/video/BV1up4y1s7VP?p=12" target="_blank" rel="noopener noreferrer">WebDAV</a> <strong>\u540C\u6B65\u5907\u4EFD</strong> IndexedDB \u6570\u636E\u5E93\u3002\u53EF\u4EE5\u5C06\u4E66\u7B7E\u6309\u7EC4\u522B<strong>\u540C\u6B65\u5206\u4EAB</strong>\u4E3A <a href="https://www.bilibili.com/video/BV1up4y1s7VP?p=10" target="_blank" rel="noopener noreferrer">Gist</a>\u3002</p><h3 id="webdav" tabindex="-1"><a class="header-anchor" href="#webdav" aria-hidden="true">#</a> WebDAV</h3><p>\u4F7F\u7528 <a href="https://github.com/perry-mitchell/webdav-client" target="_blank" rel="noopener noreferrer">webdav-client</a> \u5E93\uFF0C\u5B83\u662F\u4E00\u4E2A WebDAV \u5BA2\u6237\u7AEF\u53EF\u7528\u4E8E NodeJS \u6216\u6D4F\u89C8\u5668\u73AF\u5883\u3002</p><p>\u5728\u7EC8\u7AEF\u8F93\u5165\u4EE5\u4E0B\u547D\u4EE4\u5B89\u88C5\u8BE5\u6A21\u5757\u53CA\u5176\u76F8\u5E94\u7684\u4F9D\u8D56</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> webdav --save
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>\u7136\u540E\u57FA\u4E8E WebDAV \u670D\u52A1\u5668\u5730\u5740\u3001\u7528\u6237\u540D\u3001\u5BC6\u7801\u521B\u5EFA\u4E00\u4E2A\u5BA2\u6237\u7AEF\u5B9E\u4F8B</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// src/composables/useWebDAV.js</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> createClient <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;webdav/web&#39;</span><span class="token punctuation">;</span>

<span class="token comment">// ...</span>
<span class="token comment">// create webDAV client</span>
<span class="token keyword">const</span> <span class="token function-variable function">createWebDAVClient</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">url<span class="token punctuation">,</span> username<span class="token punctuation">,</span> password</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> client <span class="token operator">=</span> <span class="token function">createClient</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    username<span class="token punctuation">,</span>
    password<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> client<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>\u{1F4A1} \u7531\u4E8E\u6269\u5C55\u7A0B\u5E8F\u7684\u57DF\u540D\u548C\u9700\u8981\u8BBF\u95EE\u7684 WebDAV \u670D\u52A1\u5668\u57DF\u540D\u4E0D\u540C\uFF0C\u6269\u5C55\u7A0B\u5E8F\u652F\u6301\u8DE8\u57DF\u8BBF\u95EE\u5176\u4ED6\u670D\u52A1\u5668\uFF0C\u4F46\u9700\u8981\u5C06\u670D\u52A1\u5668\u5730\u5740\u6DFB\u52A0\u5230\u6269\u5C55\u7A0B\u5E8F\u7684\u914D\u7F6E\u6E05\u5355 <code>manifest.json</code> \u7684<code>host_permissions</code> \u5C5E\u6027\u4E2D\uFF0C\u4F8B\u5982\u4F7F\u7528<a href="https://help.jianguoyun.com/?p=2064" target="_blank" rel="noopener noreferrer">\u575A\u679C\u4E91\u7684 WebDAV \u670D\u52A1</a></p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token comment">// \u7701\u7565\u663E\u793A\u5176\u4ED6\u90E8\u5206</span>
  <span class="token property">&quot;host_permissions&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token string">&quot;https://dav.jianguoyun.com/dav/&quot;</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token comment">// \u7701\u7565\u663E\u793A\u5176\u4ED6\u90E8\u5206</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>\u4EE5\u4E0B\u5217\u51FA\u5728\u9879\u76EE\u4E2D\u4E0E WebDAV \u76F8\u5173\u7684\u4E00\u4E9B\u4E3B\u8981\u65B9\u6CD5</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// src/composables/useWebDAV.js</span>

<span class="token comment">// ...</span>
<span class="token comment">// \u68C0\u67E5 WebDAV \u670D\u52A1\u5668\u8FDE\u63A5\u72B6\u6001</span>
<span class="token keyword">const</span> <span class="token function-variable function">checkWebDAVConnect</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">client</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  client<span class="token punctuation">.</span><span class="token function">stat</span><span class="token punctuation">(</span><span class="token string">&#39;/&#39;</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      state<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      msg<span class="token operator">:</span> <span class="token string">&#39;\u8FDE\u63A5\u6210\u529F&#39;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">.</span>response<span class="token punctuation">.</span>status <span class="token operator">===</span> <span class="token number">401</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        state<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
        stateCode<span class="token operator">:</span> <span class="token number">401</span><span class="token punctuation">,</span>
        msg<span class="token operator">:</span> <span class="token string">&#39;\u672A\u83B7\u5F97\u8BBF\u95EE\u6743\u9650&#39;</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        state<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
        stateCode<span class="token operator">:</span> <span class="token number">404</span><span class="token punctuation">,</span>
        msg<span class="token operator">:</span> <span class="token string">&#39;\u8FDE\u63A5\u5931\u8D25&#39;</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// \u68C0\u67E5\u6587\u4EF6\u5939\u5B58\u5728\u4E0E\u5426\uFF0C\u5982\u679C\u4E0D\u5B58\u5728\u5C31\u521B\u5EFA\u4E00\u4E2A\u6587\u4EF6\u5939</span>
<span class="token keyword">const</span> <span class="token function-variable function">checkWebDAVFolder</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">client<span class="token punctuation">,</span> folderPath</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">await</span> client<span class="token punctuation">.</span><span class="token function">exists</span><span class="token punctuation">(</span>folderPath<span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">await</span> client<span class="token punctuation">.</span><span class="token function">createDirectory</span><span class="token punctuation">(</span>folderPath<span class="token punctuation">,</span> <span class="token punctuation">{</span> recursive<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// \u83B7\u53D6\u6587\u4EF6\u5939\u5185\u6240\u6709\u6587\u4EF6</span>
<span class="token keyword">const</span> <span class="token function-variable function">getWebDAVFolder</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">client<span class="token punctuation">,</span> folderPath</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  client<span class="token punctuation">.</span><span class="token function">getDirectoryContents</span><span class="token punctuation">(</span>folderPath<span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">contents</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token function">resolve</span><span class="token punctuation">(</span>contents<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;error&#39;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// \u83B7\u53D6\u6587\u4EF6\u5939\u4E2D\u6700\u540E\u66F4\u65B0\u7684\u6587\u4EF6</span>
<span class="token comment">// \u8FD9\u91CC\u662F\u4E3A\u4E86\u83B7\u53D6 WebDAV \u7684\u6700\u540E\u5907\u4EFD\u540C\u6B65\u65F6\u95F4</span>
<span class="token comment">// \u7531\u4E8E\u8BBF\u95EE\u64CD\u4F5C\u4F1A\u89E6\u53D1\u6587\u4EF6\u5939\u7684\u66F4\u65B0\uFF0C\u6240\u4EE5\u8FD9\u91CC\u5B9E\u9645\u4E0A\u662F\u83B7\u53D6\u6587\u4EF6\u5939\u4E2D\u6700\u540E\u66F4\u65B0\u7684\u6587\u4EF6\u7684\u65F6\u95F4\u6233</span>
<span class="token keyword">const</span> <span class="token function-variable function">getWebDAVLastFileState</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">client<span class="token punctuation">,</span> folderPath</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">await</span> <span class="token function">checkWebDAVFolder</span><span class="token punctuation">(</span>client<span class="token punctuation">,</span> folderPath<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> filesArr <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getWebDAVFolder</span><span class="token punctuation">(</span>client<span class="token punctuation">,</span> folderPath<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>filesArr<span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token comment">// \u7531\u4E8E\u5B58\u50A8\u7684\u5907\u4EFD\u6587\u4EF6\u547D\u540D\u89C4\u5219\u662F tagdown_{timestamp}</span>
  <span class="token comment">// \u6240\u4EE5\u6587\u4EF6\u5217\u8868\u6700\u540E\u4E00\u4E2A\u5C31\u662F\u6700\u65B0\u521B\u5EFA\u7684\u5907\u4EFD\u6587\u4EF6</span>
  <span class="token keyword">const</span> lastFile <span class="token operator">=</span> filesArr<span class="token punctuation">[</span>filesArr<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> lastFile<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// \u83B7\u53D6\u6587\u4EF6\u5185\u5BB9</span>
<span class="token keyword">const</span> getWebDAVFile <span class="token operator">=</span> <span class="token punctuation">(</span>client<span class="token punctuation">,</span> filePath<span class="token punctuation">,</span> format <span class="token operator">=</span> <span class="token string">&#39;text&#39;</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  client<span class="token punctuation">.</span><span class="token function">getFileContents</span><span class="token punctuation">(</span>filePath<span class="token punctuation">,</span> <span class="token punctuation">{</span> format <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token function">resolve</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;error&#39;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// \u5199\u5165\u6587\u4EF6\u5185\u5BB9</span>
<span class="token keyword">const</span> <span class="token function-variable function">writeWebDAVFile</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">client<span class="token punctuation">,</span> folderPath<span class="token punctuation">,</span> fileName<span class="token punctuation">,</span> data</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">await</span> <span class="token function">checkWebDAVFolder</span><span class="token punctuation">(</span>client<span class="token punctuation">,</span> folderPath<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> client<span class="token punctuation">.</span><span class="token function">putFileContents</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>folderPath<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>fileName<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">,</span> data<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    contentLength<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// console.log(res);</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>res<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      state<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      msg<span class="token operator">:</span> <span class="token string">&#39;WebDAV \u540C\u6B65\u6210\u529F&#39;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    state<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    msg<span class="token operator">:</span> <span class="token string">&#39;WebDAV \u540C\u6B65\u5931\u8D25&#39;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br></div></div><h3 id="gist" tabindex="-1"><a class="header-anchor" href="#gist" aria-hidden="true">#</a> Gist</h3><p>Github \u63D0\u4F9B\u4E86\u4E00\u7CFB\u5217 <a href="https://docs.github.com/en/rest" target="_blank" rel="noopener noreferrer">RESTful API</a>\uFF0C\u5176\u4E2D\u5305\u62EC\u4E00\u4E9B<a href="https://docs.github.com/en/rest/reference/gists" target="_blank" rel="noopener noreferrer">\u4E0E Gist \u4EA4\u4E92\u7684 APIs</a>\u3002 <a href="https://github.com/settings/tokens/new" target="_blank" rel="noopener noreferrer">\u7533\u8BF7</a>\u4E2A\u4EBA<a href="https://docs.github.com/cn/authentication/keeping-your-account-and-data-secure/creating-a-personal-access-token" target="_blank" rel="noopener noreferrer">\u8BBF\u95EE\u4EE4\u724C</a>\uFF0C\u5C31\u53EF\u4EE5\u5728\u6269\u5C55\u7A0B\u5E8F\u4E2D\u7BA1\u7406 Gist\uFF0C\u5C06\u7279\u5B9A\u7684\u4E66\u7B7E\u4EE5 gist \u4EE3\u7801\u7247\u6BB5\u7684\u5F62\u5F0F\u5206\u4EAB\u5230 Github\u3002</p><p>\u{1F4A1} \u7531\u4E8E\u5728\u5F15\u5165 <a href="https://www.axios-http.cn/" target="_blank" rel="noopener noreferrer">axios</a> \u6A21\u5757\u65F6\u51FA\u9519\uFF0C\u6240\u4EE5\u5728\u6269\u5C55\u7A0B\u5E8F\u4E2D\u4F7F\u7528 <code>fetch</code> \u5411 Github \u53D1\u9001\u7F51\u7EDC\u8BF7\u6C42\u3002</p><p>\u4EE5\u4E0B\u5217\u51FA\u5728\u9879\u76EE\u4E2D\u4E0E WebDAV \u76F8\u5173\u7684\u4E00\u4E9B\u4E3B\u8981\u65B9\u6CD5</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// src/somposables/useGist.js</span>

<span class="token comment">//...</span>
<span class="token comment">// \u521B\u5EFA Gist</span>
<span class="token keyword">const</span> <span class="token function-variable function">createGist</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">token<span class="token punctuation">,</span> gist</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">&#39;https://api.github.com/gists&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token comment">// \u4F7F\u7528 POST \u65B9\u6CD5</span>
    method<span class="token operator">:</span> <span class="token string">&#39;POST&#39;</span><span class="token punctuation">,</span>
    <span class="token comment">// \u6839\u636E\u5B98\u65B9\u6587\u6863 https://docs.github.com/en/rest/reference/gists#create-a-gist</span>
    <span class="token comment">// \u8BF7\u6C42\u4F53\u53EF\u4EE5\u8BBE\u7F6E\u591A\u79CD\u53C2\u6570\uFF0C\u5373\u5165\u53C2 gist \u53EF\u4EE5\u5305\u542B\u4EE5\u4E0B\u5C5E\u6027</span>
    <span class="token comment">// * descripton \u63CF\u8FF0 </span>
    <span class="token comment">// * files\uFF08\u5C5E\u6027\u503C\u662F\u4E00\u4E2A\u5BF9\u8C61\uFF0C\u56E0\u4E3A\u4E00\u4E2A Gist \u53EF\u4EE5\u5305\u542B\u591A\u4E2A\u4EE3\u7801\u6587\u4EF6\u7247\u6BB5\uFF0C\u8BE5\u5BF9\u8C61\u4E2D\uFF0C\u6BCF\u4E00\u4E2A\u5C5E\u6027\u5C31\u662F\u4E00\u4E2A\u6587\u4EF6\uFF0C\u5C5E\u6027\u540D\u662F\u6587\u4EF6\u540D\uFF0C\u5C5E\u6027\u503C\u662F\u6587\u4EF6\u5185\u5BB9\uFF09</span>
    <span class="token comment">// * public\uFF0C\u662F\u5426\u4E3A\u516C\u5F00 Gist \u6216\u79C1\u5BC6 Gist </span>
    body<span class="token operator">:</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>gist<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token comment">// \u5728\u8BF7\u6C42\u5934\u6DFB\u52A0\u8BA4\u8BC1\u4FE1\u606F</span>
    headers<span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Headers</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token string">&#39;Content-Type&#39;</span><span class="token operator">:</span> <span class="token string">&#39;application/json&#39;</span><span class="token punctuation">,</span>
      Authorization<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">Bearer </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>token<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>res<span class="token punctuation">.</span>status <span class="token operator">===</span> <span class="token number">201</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> resData <span class="token operator">=</span> <span class="token keyword">await</span> res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        state<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        msg<span class="token operator">:</span> <span class="token string">&#39;\u521B\u5EFA\u6210\u529F&#39;</span><span class="token punctuation">,</span>
        data<span class="token operator">:</span> resData<span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;fail&#39;</span><span class="token punctuation">,</span> res<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        state<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
        msg<span class="token operator">:</span> <span class="token string">&#39;\u521B\u5EFA\u5931\u8D25&#39;</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">&#39;Error:&#39;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token punctuation">{</span>
        state<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
        msg<span class="token operator">:</span> <span class="token string">&#39;\u521B\u5EFA\u5931\u8D25&#39;</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// \u66F4\u65B0 Gist</span>
<span class="token keyword">const</span> <span class="token function-variable function">updateGist</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">token<span class="token punctuation">,</span> gistId<span class="token punctuation">,</span> data</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">https://api.github.com/gists/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>gistId<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token comment">// \u4F7F\u7528 PATCH \u65B9\u6CD5</span>
    method<span class="token operator">:</span> <span class="token string">&#39;PATCH&#39;</span><span class="token punctuation">,</span>
    <span class="token comment">// \u6839\u636E\u5B98\u65B9\u6587\u6863 https://docs.github.com/en/rest/reference/gists#update-a-gist</span>
    <span class="token comment">// \u8BF7\u6C42\u4F53\u53EF\u4EE5\u8BBE\u7F6E\u591A\u79CD\u53C2\u6570\uFF0C\u5373\u5165\u53C2 data \u53EF\u4EE5\u5305\u542B\u4EE5\u4E0B\u5C5E\u6027</span>
    <span class="token comment">// * gist_id \u9700\u8981\u66F4\u65B0\u7684 Gist ID</span>
    <span class="token comment">// * desciption \u63CF\u8FF0</span>
    <span class="token comment">// * files \u6587\u4EF6 files\uFF08\u5C5E\u6027\u503C\u662F\u4E00\u4E2A\u5BF9\u8C61\uFF0C\u56E0\u4E3A\u4E00\u4E2A Gist \u53EF\u4EE5\u5305\u542B\u591A\u4E2A\u4EE3\u7801\u6587\u4EF6\u7247\u6BB5\uFF0C\u8BE5\u5BF9\u8C61\u4E2D\uFF0C\u6BCF\u4E00\u4E2A\u5C5E\u6027\u5C31\u662F\u4E00\u4E2A\u6587\u4EF6\uFF0C\u5C5E\u6027\u540D\u662F\u6587\u4EF6\u540D\uFF0C\u5C5E\u6027\u503C\u662F\u6587\u4EF6\u5185\u5BB9\uFF09</span>
    body<span class="token operator">:</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token operator">...</span>data<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    headers<span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Headers</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token string">&#39;Content-Type&#39;</span><span class="token operator">:</span> <span class="token string">&#39;application/json&#39;</span><span class="token punctuation">,</span>
      Authorization<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">Bearer </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>token<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>res<span class="token punctuation">.</span>status <span class="token operator">===</span> <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> resData <span class="token operator">=</span> <span class="token keyword">await</span> res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        state<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        msg<span class="token operator">:</span> <span class="token string">&#39;\u66F4\u65B0\u6210\u529F&#39;</span><span class="token punctuation">,</span>
        data<span class="token operator">:</span> resData<span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;fail&#39;</span><span class="token punctuation">,</span> res<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        state<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
        msg<span class="token operator">:</span> <span class="token string">&#39;\u66F4\u65B0\u5931\u8D25&#39;</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">&#39;Error:&#39;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token punctuation">{</span>
        state<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
        msg<span class="token operator">:</span> <span class="token string">&#39;\u66F4\u65B0\u5931\u8D25&#39;</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br></div></div><h2 id="\u540E\u53F0\u76D1\u63A7" tabindex="-1"><a class="header-anchor" href="#\u540E\u53F0\u76D1\u63A7" aria-hidden="true">#</a> \u540E\u53F0\u76D1\u63A7</h2><p>\u26A0\uFE0F \u5982\u679C\u5E0C\u671B\u5728\u540E\u53F0\u811A\u672C\u4E2D <code>import</code> \u5F15\u5165\u5176\u4ED6\u5E93\uFF0C\u9700\u8981\u5728\u914D\u7F6E\u6E05\u5355 <code>manifest.json</code> \u4E2D\u5C06\u540E\u53F0\u811A\u672C\u7C7B\u578B\u58F0\u660E\u4E3A\u6A21\u5757 <code>module</code></p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
  <span class="token property">&quot;background&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;service_worker&quot;</span><span class="token operator">:</span> <span class="token string">&quot;./background/main.js&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;module&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>\u6269\u5C55\u7A0B\u5E8F\u7684\u540E\u53F0\u662F\u4E00\u4E2A service worker\uFF0C\u57FA\u4E8E\u76D1\u63A7\u4E8B\u4EF6-\u4F5C\u51FA\u54CD\u5E94\u7684\u6A21\u5F0F\u6267\u884C\u547D\u4EE4\u3002</p><p>\u53EF\u4EE5\u5728\u540E\u53F0\u76D1\u63A7\u6807\u7B7E\u9875\u7684\u5207\u6362\u4E8B\u4EF6\uFF0C\u67E5\u8BE2\u5F53\u524D\u6FC0\u6D3B\u6807\u7B7E\u9875 URL \u662F\u5426\u4E0E\u4EFB\u4F55\u5DF2\u4FDD\u5B58\u7684\u4E66\u7B7E\u76F8\u5339\u914D\uFF0C\u52A8\u6001\u66F4\u6539 Action \u56FE\u6807\u3002\u5B9E\u73B0\u7C7B\u4F3C\u4E8E Chrome \u5730\u5740\u680F\u53F3\u4FA7\u7684\u661F\u578B\u56FE\u6807\u5207\u6362\u72B6\u6001\uFF0C\u4EE5\u6307\u793A\u5F53\u524D\u6807\u7B7E\u662F\u5426\u5DF2\u6536\u85CF\u7684\u529F\u80FD\u3002</p><p><img src="`+l+`" alt="change action"></p><p>\u4E3B\u8981\u4F7F\u7528 Chrome \u63D0\u4F9B\u7684\u4E24\u4E2A APIs \u5B9E\u73B0\u8BE5\u529F\u80FD\uFF1A</p><ul><li><code>chrome.action.setIcon</code> \u52A8\u6001\u8BBE\u7F6E Action \u56FE\u6807</li><li><code>chrome.tabs.onActivated</code> \u76D1\u542C\u6807\u7B7E\u6FC0\u6D3B\u4E8B\u4EF6</li></ul><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// src/backrground/main.js</span>
<span class="token comment">// ...</span>

<span class="token doc-comment comment">/**
 * \u57FA\u4E8E\u5F53\u524D\u6FC0\u6D3B\u6807\u7B7E\u662F\u5426\u88AB\u6536\u85CF\uFF0C\u52A8\u6001\u66F4\u6539 Action \u56FE\u6807
 */</span>
<span class="token keyword">const</span> <span class="token function-variable function">changeActionIcon</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">tag <span class="token operator">=</span> <span class="token boolean">false</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>tag<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">await</span> chrome<span class="token punctuation">.</span>action<span class="token punctuation">.</span><span class="token function">setIcon</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      path<span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token number">16</span><span class="token operator">:</span> <span class="token string">&#39;/icons/icon16_tag.png&#39;</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token keyword">await</span> chrome<span class="token punctuation">.</span>action<span class="token punctuation">.</span><span class="token function">setIcon</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      path<span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token number">16</span><span class="token operator">:</span> <span class="token string">&#39;/icons/icon16_untag.png&#39;</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// \u76D1\u542C\u6807\u7B7E\u6FC0\u6D3B\u4E8B\u4EF6\uFF0C\u56DE\u8C03\u51FD\u6570\u63A5\u6536\u4E00\u4E2A\u5BF9\u8C61\u5165\u53C2\uFF0C\u5B83\u5305\u542B\u6FC0\u6D3B\u6807\u7B7E\u7684 tabId</span>
chrome<span class="token punctuation">.</span>tabs<span class="token punctuation">.</span>onActivated<span class="token punctuation">.</span><span class="token function">addListener</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">activeInfo</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// \u57FA\u4E8E\u6FC0\u6D3B\u6807\u7B7E\u7684 tabId \u83B7\u53D6\u6807\u7B7E\u5BF9\u8C61\uFF0C\u4ECE\u800C\u5F97\u5230\u76F8\u5E94\u7684 url</span>
  <span class="token keyword">const</span> tab <span class="token operator">=</span> <span class="token keyword">await</span> chrome<span class="token punctuation">.</span>tabs<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>activeInfo<span class="token punctuation">.</span>tabId<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> url <span class="token operator">=</span> tab<span class="token punctuation">.</span>url <span class="token operator">||</span> tab<span class="token punctuation">.</span>pendingUrl<span class="token punctuation">;</span>
  <span class="token comment">// \u57FA\u4E8E url \u67E5\u627E\u662F\u5426\u6709\u5DF2\u6536\u85CF\u7684\u4E66\u7B7E\u4E0E\u4E4B\u5339\u914D\uFF0C\u8FD4\u56DE\u4E00\u4E2A\u5305\u542B\u6240\u6709\u5339\u914D\u4E66\u7B7E\u8282\u70B9\u7684\u6570\u7EC4</span>
  <span class="token keyword">const</span> nodes <span class="token operator">=</span> <span class="token keyword">await</span> chrome<span class="token punctuation">.</span>bookmarks<span class="token punctuation">.</span><span class="token function">search</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    url<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">let</span> bookmarkState <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>nodes<span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// \u672A\u627E\u5230\u5339\u914D\u4E66\u7B7E</span>
    bookmarkState <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token comment">// \u627E\u5230\u81F3\u5C11\u4E00\u4E2A\u5339\u914D\u4E66\u7B7E</span>
    bookmarkState <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span> 
  <span class="token punctuation">}</span>

  <span class="token comment">// \u57FA\u4E8E\u4E66\u7B7E\u5339\u914D\u60C5\u51B5\u66F4\u6539 Action \u56FE\u6807</span>
  <span class="token keyword">await</span> <span class="token function">changeActionIcon</span><span class="token punctuation">(</span>bookmarkState<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br></div></div><p>\u{1F4A1} \u8FD8\u53EF\u4EE5\u57FA\u4E8E\u76D1\u63A7\u5176\u4ED6\u4E8B\u4EF6\uFF0C\u52A8\u6001\u66F4\u6539 Action \u56FE\u6807\uFF1A</p><ul><li><code>chrome.windows.onFocusChanged</code> \u6D4F\u89C8\u5668\u7A97\u53E3\u66F4\u6539\u4E8B\u4EF6</li><li><code>chrome.tabs.onUpdated</code> \u6807\u7B7E\u66F4\u65B0\u4E8B\u4EF6\uFF0C\u4F8B\u5982\u6807\u7B7E\u9875\u7684 URL \u66F4\u6539\u65F6</li><li><code>chrome.bookmarks.onCreated</code> \u65B0\u589E\u4E66\u7B7E\u4E8B\u4EF6</li></ul><h2 id="\u8BBE\u7F6E\u9875\u9762\u5F00\u53D1" tabindex="-1"><a class="header-anchor" href="#\u8BBE\u7F6E\u9875\u9762\u5F00\u53D1" aria-hidden="true">#</a> \u8BBE\u7F6E\u9875\u9762\u5F00\u53D1</h2><p>\u5728\u8BBE\u7F6E\u9875\u9762\u4E2D\u4E3B\u8981\u63D0\u4F9B\u4E86 IndexedDB \u6570\u636E\u5E93\u7684\u5BFC\u51FA\u3001\u5BFC\u5165\uFF0C\u4EE5\u53CA\u4E66\u7B7E\u6309\u9700\u5BFC\u51FA\u529F\u80FD\u3002</p><p>\u76EE\u524D\u6709\u591A\u79CD\u5E93\u652F\u6301\u5728\u524D\u7AEF\u5C06\u6570\u636E\u5BFC\u51FA\u4E3A\u6587\u4EF6\uFF0C\u4F8B\u5982 <a href="https://github.com/eligrey/FileSaver.js" target="_blank" rel="noopener noreferrer">FileSaver.js</a>\u3001<a href="http://danml.com/download.html" target="_blank" rel="noopener noreferrer">download.js</a>\uFF0C\u5728 TagDown \u7684\u914D\u7F6E\u9875\u4E2D\uFF0C\u7528 Vanilla JS \u5B9E\u73B0\u4E86\u7C7B\u4F3C\u7684\u529F\u80FD\uFF1A</p><div class="language-vue ext-vue line-numbers-mode"><pre class="language-vue"><code>// src/options/App.vue

const exportJsonFile = (blob, fileName) =&gt; {
  if (!blob) return;
  const a = document.createElement(&#39;a&#39;);
  const url = window.URL.createObjectURL(blob);
  a.href = url;
  a.download = \`\${fileName}.json\`;
  a.click();
};


// \u5C06\u5BF9\u8C61\u578B\u6570\u636E\u8F6C\u6362\u4E3A JSON \u683C\u5F0F
const jsonData = JSON.stringify(data, null, 2);
// \u518D\u57FA\u4E8E JSON \u683C\u5F0F\u7684\u6570\u636E\u521B\u5EFA Blob \u6570\u636E
const blob = new Blob([jsonFile], { type: &#39;application/json&#39; });

// \u518D\u89E6\u53D1\u4E0B\u8F7D\u64CD\u4F5C
exportJsonFile(blob, &#39;\u6570\u636E\u5BFC\u51FA&#39;)
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div>`,190);function i(k,b){return r}var g=s(u,[["render",i]]);export{g as default};
