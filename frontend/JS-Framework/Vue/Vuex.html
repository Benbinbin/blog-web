<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.27">
    <link rel="icon" href="/blog-web/images/favicon.ico"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.5/dist/katex.min.css"><title>Vuex | Blog</title><meta name="description" content="A blog and knowledge management system about web.">
    <link rel="modulepreload" href="/blog-web/assets/app.43fe0c63.js"><link rel="modulepreload" href="/blog-web/assets/Vuex.html.1d32a24b.js"><link rel="modulepreload" href="/blog-web/assets/plugin-vue_export-helper.21dcd24c.js"><link rel="modulepreload" href="/blog-web/assets/Vuex.html.75cc34c8.js">
    <link rel="stylesheet" href="/blog-web/assets/style.b42fd117.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="min-h-screen flex flex-col"><nav class="px-4 sm:px-8 py-2 flex justify-between items-center sticky top-0 z-30 bg-white"><div class="left flex items-center space-x-0.5"><!--[--><button class="text-gray-400 hover:bg-gray-100 catelog-btn p-2 select-none text-sm font-bold hover:text-gray-900 rounded-md lg:hidden"><svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" fill="currentColor" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M5 11.5a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5zm-3 1a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm0 4a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm0 4a1 1 0 1 0 0-2 1 1 0 0 0 0 2z"></path></svg></button><!--]--><a class="avatar p-2 hover:bg-gray-100 rounded-md" href="/blog-web/#"><img src="/blog-web/images/avatar.png" alt="avatar" class="w-10 h-10 rounded-full"></a></div><div class="right hidden sm:flex items-center space-x-0.5"><!--[--><button class="text-gray-400 p-2 select-none text-sm font-bold hover:text-gray-900 hover:bg-gray-100 rounded-md">All</button><button class="text-gray-400 p-2 select-none text-sm font-bold hover:text-gray-900 hover:bg-gray-100 rounded-md">Network</button><button class="text-gray-400 p-2 select-none text-sm font-bold hover:text-gray-900 hover:bg-gray-100 rounded-md">Frontend</button><button class="text-gray-400 p-2 select-none text-sm font-bold hover:text-gray-900 hover:bg-gray-100 rounded-md">Backend</button><button class="text-gray-400 p-2 select-none text-sm font-bold hover:text-gray-900 hover:bg-gray-100 rounded-md">Project</button><!--]--><!--[--><button class="text-gray-900 bg-gray-100 hover:bg-gray-200 p-2 select-none text-sm font-bold hover:text-gray-900 rounded-md hidden lg:block"><svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" fill="currentColor" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M5 11.5a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5zm-3 1a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm0 4a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm0 4a1 1 0 1 0 0-2 1 1 0 0 0 0 2z"></path></svg></button><!--]--></div><div class="more-container sm:hidden relative"><button style="" class="p-2 select-none hover:bg-gray-100 rounded-md text-gray-500"><svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" fill="currentColor" viewBox="0 0 16 16"><path d="M9.5 13a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zm0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zm0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0z"></path></svg></button><button style="display:none;" class="p-2 select-none hover:bg-gray-100 rounded-md text-red-400 hover:text-red-500"><svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" fill="currentColor" viewBox="0 0 16 16"><path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"></path><path d="M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"></path></svg></button><div style="display:none;" class="more-modal p-2 absolute top-10 right-0 z-10 flex flex-col space-y-2 bg-gray-100 rounded-md opacity-90"><!--[--><button class="text-gray-400 px-4 py-2 select-none text-sm text-center font-bold hover:text-gray-900 hover:bg-gray-200 rounded-md">All</button><button class="text-gray-400 px-4 py-2 select-none text-sm text-center font-bold hover:text-gray-900 hover:bg-gray-200 rounded-md">Network</button><button class="text-gray-400 px-4 py-2 select-none text-sm text-center font-bold hover:text-gray-900 hover:bg-gray-200 rounded-md">Frontend</button><button class="text-gray-400 px-4 py-2 select-none text-sm text-center font-bold hover:text-gray-900 hover:bg-gray-200 rounded-md">Backend</button><button class="text-gray-400 px-4 py-2 select-none text-sm text-center font-bold hover:text-gray-900 hover:bg-gray-200 rounded-md">Project</button><!--]--></div></div></nav><div class="relative flex-grow"><div class="theme-container no-navbar no-sidebar"><!--[--><!----><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><!----><!--[--><!--]--><ul class="sidebar-links"><!--[--><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><h1 id="vuex" tabindex="-1"><a class="header-anchor" href="#vuex" aria-hidden="true">#</a> Vuex</h1><p><a href="https://vuex.vuejs.org/zh/" target="_blank" rel="noopener noreferrer">Vuex</a> æ˜¯ä¸€ä¸ªä¸“ä¸º Vue.js åº”ç”¨ç¨‹åºå¼€å‘çš„<strong>çŠ¶æ€ç®¡ç†æ¨¡å—</strong>ã€‚å®ƒé‡‡ç”¨é›†ä¸­å¼å­˜å‚¨ç®¡ç†åº”ç”¨çš„æ‰€æœ‰ç»„ä»¶çš„çŠ¶æ€ï¼Œå¹¶ä»¥ç›¸åº”çš„è§„åˆ™ä¿è¯çŠ¶æ€ä»¥ä¸€ç§å¯é¢„æµ‹çš„æ–¹å¼å‘ç”Ÿå˜åŒ–ã€‚Vuex ä½¿ç”¨<strong>å•ä¸€çŠ¶æ€æ ‘</strong>ï¼Œå³åªç”¨ä¸€ä¸ªå¯¹è±¡å°±åŒ…å«äº†å…¨éƒ¨çš„åº”ç”¨å±‚çº§ï¼ˆç»„ä»¶ï¼‰çš„çŠ¶æ€ï¼Œå®ƒä½œä¸ºã€Œå”¯ä¸€æ•°æ®æºã€ <a href="https://en.wikipedia.org/wiki/Single_source_of_truth" target="_blank" rel="noopener noreferrer">SSOT</a> è€Œå­˜åœ¨ï¼Œè¿™ä¹Ÿæ„å‘³ç€æ¯ä¸ªåº”ç”¨å°†<strong>ä»…ä»…åŒ…å«ä¸€ä¸ª store å®ä¾‹</strong>ã€‚å•ä¸€çŠ¶æ€æ ‘è®©æˆ‘ä»¬èƒ½å¤Ÿç›´æ¥åœ°å®šä½ä»»ä¸€ç‰¹å®šçš„çŠ¶æ€ç‰‡æ®µï¼Œåœ¨è°ƒè¯•çš„è¿‡ç¨‹ä¸­ä¹Ÿèƒ½è½»æ˜“åœ°å–å¾—æ•´ä¸ªå½“å‰åº”ç”¨çŠ¶æ€çš„å¿«ç…§ã€‚</p><p>ç±»ä¼¼äºé«˜çº§çš„ event busï¼Œå°†ç»„ä»¶çš„æ•°æ®ã€Œé›†ä¸­ã€åœ¨ Vuex æ¨¡å—ä¸­ï¼Œå¯ä»¥ååˆ†æ–¹ä¾¿å®ç°ç»„ä»¶é—´æ•°æ®ä¼ é€’ã€‚ä½†æ˜¯ç”±äºå®ƒéš”ç¦»çŠ¶æ€ç®¡ç†ä¸­çš„å„ç§æ¦‚å¿µå¹¶é€šè¿‡å¼ºåˆ¶è§„åˆ™ç»´æŒè§†å›¾å’ŒçŠ¶æ€é—´çš„ç‹¬ç«‹æ€§ï¼Œåœ¨å¤§å‹é¡¹ç›®ä¸­ä½¿å¾—ä»£ç æ›´ç»“æ„åŒ–ä¸”æ˜“ç»´æŠ¤ï¼›ä½†å®ƒçš„é…ç½®å’Œè§„åˆ™ç¹çï¼Œå¯¹äºå°å‹é¡¹ç›®ä½¿ç”¨ä¸€èˆ¬æ–¹å¼ç®¡ç†æ•°æ®æ›´æ–¹ä¾¿ï¼Œæ¯ä¸ªç»„ä»¶æ•°æ®ç‹¬ç«‹ç®¡ç†ï¼Œç»„ä»¶é—´ <code>props</code>ã€<code>emit</code> æˆ– event bus ç­‰æ–¹å¼è¿›è¡Œä¿¡æ¯ä¼ é€’ã€‚</p><p>ğŸ’¡ Vuex ä¹Ÿé›†æˆåˆ° Vue çš„å®˜æ–¹è°ƒè¯•å·¥å…· <a href="https://github.com/vuejs/vue-devtools" target="_blank" rel="noopener noreferrer">devtools extension</a>ï¼Œæä¾›äº†è¯¸å¦‚é›¶é…ç½®çš„ time-travel è°ƒè¯•ã€çŠ¶æ€å¿«ç…§å¯¼å…¥å¯¼å‡ºç­‰é«˜çº§è°ƒè¯•åŠŸèƒ½ã€‚</p><p><img src="/blog-web/assets/20200602223405863_25715.7f5f14ba.png" alt="Vuex"></p><h2 id="å®‰è£…-vuex" tabindex="-1"><a class="header-anchor" href="#å®‰è£…-vuex" aria-hidden="true">#</a> å®‰è£… Vuex</h2><p>åœ¨ç»ˆç«¯è¾“å…¥ä»¥ä¸‹ä»£ç å®‰è£… Vuex æ¨¡å—</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> vuex --save
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>âš ï¸ Vuex ä¾èµ– <a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Guide/Using_promises" target="_blank" rel="noopener noreferrer">Promise</a>ã€‚å¦‚æœä½ æ”¯æŒçš„æµè§ˆå™¨å¹¶æ²¡æœ‰å®ç° Promise (æ¯”å¦‚ IE)ï¼Œé‚£ä¹ˆä½ å¯ä»¥ä½¿ç”¨ä¸€ä¸ª polyfill çš„åº“ï¼Œå¦‚ <a href="https://github.com/stefanpenner/es6-promise" target="_blank" rel="noopener noreferrer">es6-promise</a>ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ CDN å°†å…¶å¼•å…¥ï¼š</p><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://cdn.jsdelivr.net/npm/es6-promise@4/dist/es6-promise.auto.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>ç„¶ååœ¨ Webpack å…¥å£ entry æ–‡ä»¶ <code>main.js</code> ä¸­å¯¼å…¥æ¨¡å—ï¼Œå¹¶é€šè¿‡ <code>Vue.use(Vuex)</code> å¯ç”¨å®ƒ</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// ğŸ“ main.js</span>
<span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">&#39;vue&#39;</span>
<span class="token keyword">import</span> Vuex <span class="token keyword">from</span> <span class="token string">&#39;vuex&#39;</span>

Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>Vuex<span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="æ ¸å¿ƒæ¦‚å¿µ" tabindex="-1"><a class="header-anchor" href="#æ ¸å¿ƒæ¦‚å¿µ" aria-hidden="true">#</a> æ ¸å¿ƒæ¦‚å¿µ</h2><p>Vuex å®ä¾‹ <code>new Vuex.Store({})</code> æ˜¯ä¸€ä¸ªä»“åº“ store åŸºæœ¬ä¸Šå°±æ˜¯ä¸€ä¸ªå®¹å™¨ï¼Œå®ƒåŒ…å«ç€ä½ çš„åº”ç”¨ä¸­å¤§éƒ¨åˆ†çš„<strong>çŠ¶æ€ (state)</strong>ï¼Œå®ƒå’Œå•çº¯çš„å…¨å±€å¯¹è±¡æœ‰ä»¥ä¸‹ä¸¤ç‚¹ä¸åŒï¼š</p><ul><li><p>Vuex çš„çŠ¶æ€å­˜å‚¨æ˜¯<strong>å“åº”å¼</strong>çš„ã€‚å½“ Vue ç»„ä»¶ä» store ä¸­è¯»å–çŠ¶æ€çš„æ—¶å€™ï¼Œè‹¥ store ä¸­çš„çŠ¶æ€å‘ç”Ÿå˜åŒ–ï¼Œé‚£ä¹ˆç›¸åº”çš„ç»„ä»¶ä¹Ÿä¼šç›¸åº”åœ°å¾—åˆ°é«˜æ•ˆæ›´æ–°ã€‚</p></li><li><p><strong>ä¸èƒ½</strong>ç›´æ¥æ”¹å˜ store ä¸­çš„çŠ¶æ€ã€‚æ”¹å˜ store ä¸­çš„çŠ¶æ€çš„å”¯ä¸€é€”å¾„å°±æ˜¯æ˜¾å¼åœ°<strong>æäº¤ commitï¼ˆç„¶å Vuex ä¼šè‡ªåŠ¨åœ°è°ƒç”¨ <code>mutation</code> å¯¹è±¡é‡Œç›¸åº”çš„æ–¹æ³•ä¿®æ”¹ <code>state</code> ä¸­çš„æ•°æ®ï¼‰</strong>ã€‚è¿™æ ·ä½¿å¾—æˆ‘ä»¬å¯ä»¥æ–¹ä¾¿åœ°è·Ÿè¸ªæ¯ä¸€ä¸ªçŠ¶æ€çš„å˜åŒ–ï¼Œå¦‚ä½¿ç”¨ Vue çš„å®˜æ–¹è°ƒè¯•å·¥å…· <a href="https://github.com/vuejs/vue-devtools" target="_blank" rel="noopener noreferrer">devtools extension</a> æŸ¥çœ‹æ¯ä¸€æ¬¡ <code>commit</code> å¯¹åº”çš„ç»„ä»¶ï¼ˆæ•°æ®ï¼‰çŠ¶æ€å˜åŒ–ï¼Œä»è€Œè®©æˆ‘ä»¬èƒ½å¤Ÿå®ç°ä¸€äº›å·¥å…·å¸®åŠ©æˆ‘ä»¬æ›´å¥½åœ°äº†è§£æˆ‘ä»¬çš„åº”ç”¨</p></li></ul><p>âš ï¸ å¦‚æœ <code>state</code> ä¸­å­˜å‚¨çš„æ•°æ®æ˜¯å¯¹è±¡ï¼Œéœ€è¦åœ¨ç»„ä»¶ä¸­ä½¿ç”¨<strong>æ·±æ‹·è´</strong> <code>Object.assign({}, state_object_target)</code> çš„æ–¹å¼å¼•å…¥ vuex ä»“åº“çš„æ•°æ®</p><p>Vuex å®ä¾‹æœ‰å‡ ä¸ªæ ¸å¿ƒæ¦‚å¿µ</p><ul><li><code>state</code></li><li><code>actions</code></li><li><code>mutations</code></li><li><code>getters</code></li></ul><p><img src="/blog-web/assets/20200602225020637_19393.f9511c22.png" alt="ä½¿ç”¨ Vuex å¯¹ç»„ä»¶è¿›è¡ŒçŠ¶æ€ç®¡ç†"></p><h2 id="state" tabindex="-1"><a class="header-anchor" href="#state" aria-hidden="true">#</a> state</h2><p><code>state</code> è¯¥å¯¹è±¡æ˜¯å­˜å‚¨åœ¨ Vuex ä¸­çš„åº”ç”¨/ç»„ä»¶çš„æ•°æ®ï¼Œå’Œ Vue å®ä¾‹ä¸­çš„ <code>data</code> éµå¾ªç›¸åŒçš„è§„åˆ™ï¼Œå¦‚çŠ¶æ€å¯¹è±¡å¿…é¡»æ˜¯<a href="https://cn.vuejs.org/v2/api/#data" target="_blank" rel="noopener noreferrer">çº¯ç²¹ plain</a> çš„ã€‚<strong>ç”±äº Vuex çš„çŠ¶æ€å­˜å‚¨æ˜¯å“åº”å¼çš„ï¼Œå¦‚æœç»„ä»¶è¦ä» store å®ä¾‹ä¸­è¯»å–çŠ¶æ€æœ€ç®€å•çš„æ–¹æ³•å°±æ˜¯ä½¿ç”¨è®¡ç®—å±æ€§ <code>computed</code>ï¼Œå¹¶è¿”å› <code>state</code> ä¸­æŸä¸ªçŠ¶æ€ï¼ˆå±æ€§ï¼‰</strong></p><div class="language-vue ext-vue line-numbers-mode"><pre class="language-vue"><code>// åˆ›å»ºä¸€ä¸ª Counter ç»„ä»¶
const Counter = {
  template: `<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>{{ count }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>`,
  computed: {
    count () {
      return store.state.count
    }
  }
}
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>ä¸Šè¿°ç¤ºä¾‹ä»£ç ä¸­æ¯å½“ Vuex ä»“åº“ä¸­ <code>store.state.count</code> å˜åŒ–çš„æ—¶å€™ï¼Œéƒ½ä¼šé‡æ–°æ±‚å–è®¡ç®—å±æ€§ï¼Œå¹¶ä¸”è§¦å‘ç›¸åº”ç»„ä»¶æ›´æ–°ç›¸å…³è”çš„ DOMã€‚</p><p>ğŸ’¡ ä¸ºäº†é¿å…åœ¨æ¯ä¸ªç»„ä»¶éƒ½è¦å¯¼å…¥åˆ›å»º Vuex å®ä¾‹çš„è„šæœ¬æ–‡ä»¶ï¼ŒVuex é€šè¿‡ <code>store</code> é€‰é¡¹æä¾›äº†ä¸€ç§æœºåˆ¶å°†çŠ¶æ€ä»æ ¹ç»„ä»¶ <code>App.vue</code>ã€Œæ³¨å…¥ã€åˆ°æ¯ä¸€ä¸ªå­ç»„ä»¶ä¸­</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>// ğŸ“ App.vue
const app = new Vue({
  el: &#39;#app&#39;,
  // æŠŠ store å¯¹è±¡æä¾›ç»™ â€œstoreâ€ é€‰é¡¹ï¼Œè¿™å¯ä»¥æŠŠ store çš„å®ä¾‹æ³¨å…¥æ‰€æœ‰çš„å­ç»„ä»¶
  store,
  components: { Counter },
  template: `
    &lt;div class=&quot;app&quot;&gt;
      &lt;counter&gt;&lt;/counter&gt;
    &lt;/div&gt;
  `
})
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>é€šè¿‡åœ¨æ ¹å®ä¾‹ä¸­æ³¨å†Œ <code>store</code> é€‰é¡¹ï¼Œè¯¥ store å®ä¾‹ä¼šæ³¨å…¥åˆ°æ ¹ç»„ä»¶ä¸‹çš„æ‰€æœ‰å­ç»„ä»¶ä¸­ï¼Œä¸”å­ç»„ä»¶èƒ½é€šè¿‡ <code>this.$store</code> è®¿é—®åˆ°</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>// ğŸ“ å­ç»„ä»¶ Counter
const Counter = {
  template: `&lt;div&gt;{{ count }}&lt;/div&gt;`,
  computed: {
    count () {
      return this.$store.state.count
    }
  }
}
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>ğŸ’¡ä½¿ç”¨ Vuex å¹¶ä¸æ„å‘³ç€ä½ éœ€è¦å°†åº”ç”¨/ç»„ä»¶<strong>æ‰€æœ‰çš„</strong>çŠ¶æ€æ”¾å…¥ Vuexã€‚è™½ç„¶å°†æ‰€æœ‰çš„çŠ¶æ€æ”¾åˆ° Vuex ä¼šä½¿çŠ¶æ€å˜åŒ–æ›´æ˜¾å¼å’Œæ˜“è°ƒè¯•ï¼Œä½†ä¹Ÿä¼šä½¿ä»£ç å˜å¾—å†—é•¿å’Œä¸ç›´è§‚ã€‚å¦‚æœæœ‰äº›çŠ¶æ€ä¸¥æ ¼å±äºå•ä¸ªç»„ä»¶ï¼Œæœ€å¥½è¿˜æ˜¯ä½œä¸ºç»„ä»¶çš„å±€éƒ¨çŠ¶æ€ï¼Œè¿™äº›çŠ¶æ€åœ¨ç»„ä»¶çš„ <code>data</code> æ•°æ®å¯¹è±¡ä¸­ä¿å­˜ã€‚ä½ åº”è¯¥æ ¹æ®ä½ çš„åº”ç”¨å¼€å‘éœ€è¦è¿›è¡Œæƒè¡¡å’Œç¡®å®šã€‚</p><h2 id="getters" tabindex="-1"><a class="header-anchor" href="#getters" aria-hidden="true">#</a> getters</h2><p><img src="/blog-web/assets/20200621224839125_23363.bceb1b5e.png" alt="getters"></p><p>æœ‰æ—¶å€™æˆ‘ä»¬éœ€è¦ä» store ä¸­çš„ state ä¸­æ´¾ç”Ÿå‡ºä¸€äº›çŠ¶æ€ï¼Œå¦‚å¯¹åˆ—è¡¨è¿›è¡Œè¿‡æ»¤ï¼ŒVuex å…è®¸æˆ‘ä»¬åœ¨ store ä¸­å®šä¹‰ <code>getters</code>ï¼ˆå¯ä»¥è®¤ä¸ºæ˜¯ store çš„è®¡ç®—å±æ€§ï¼‰ï¼Œgetter æ¥å— <code>state</code> ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ï¼Œç„¶ååœ¨å…¶å‡½æ•°å†…éƒ¨å¯¹å…¶è¿›è¡Œæ“ä½œï¼Œæœ€åå°†è¿ç®—ç»“æœä½œä¸ºè¿”å›å€¼ã€‚</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vuex<span class="token punctuation">.</span>Store</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  state<span class="token operator">:</span> <span class="token punctuation">{</span>
    todos<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span> id<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> text<span class="token operator">:</span> <span class="token string">&#39;...&#39;</span><span class="token punctuation">,</span> done<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span> id<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span> text<span class="token operator">:</span> <span class="token string">&#39;...&#39;</span><span class="token punctuation">,</span> done<span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  getters<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// å¯¹åˆ—è¡¨è¿›è¡Œè¿‡æ»¤</span>
    <span class="token comment">// æ¥å— state ä½œä¸ºå…¶ç¬¬ä¸€ä¸ªå‚æ•°</span>
    <span class="token function-variable function">doneTodos</span><span class="token operator">:</span> <span class="token parameter">state</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> state<span class="token punctuation">.</span>todos<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token parameter">todo</span> <span class="token operator">=&gt;</span> todo<span class="token punctuation">.</span>done<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>åœ¨ä»»ä½•ç»„ä»¶ä¸­ Getter ä¼šæš´éœ²ä¸º <code>this.$store.getters</code> å¯¹è±¡çš„å±æ€§ï¼Œå¯ä»¥é€šè¿‡è®¿é—®å±æ€§çš„å½¢å¼è°ƒç”¨è¿™äº›å€¼</p><div class="language-vue ext-vue line-numbers-mode"><pre class="language-vue"><code>// ç»„ä»¶çš„è®¡ç®—å±æ€§
computed: {
  doneTodosCount () {
    return this.$store.getters.doneTodos
  }
}
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>ğŸ’¡ å°±åƒè®¡ç®—å±æ€§ä¸€æ ·ï¼Œgetter çš„è¿”å›å€¼ä¼šæ ¹æ®å®ƒçš„ä¾èµ–è¢«ç¼“å­˜èµ·æ¥ï¼Œä¸”åªæœ‰å½“å®ƒçš„ä¾èµ–å€¼å‘ç”Ÿäº†æ”¹å˜æ‰ä¼šè¢«é‡æ–°è®¡ç®—ï¼›ä½†<a href="https://vuex.vuejs.org/zh/guide/getters.html#%E9%80%9A%E8%BF%87%E6%96%B9%E6%B3%95%E8%AE%BF%E9%97%AE" target="_blank" rel="noopener noreferrer">å½“ getter åœ¨é€šè¿‡æ–¹æ³•è®¿é—®</a>æ—¶ï¼Œæ¯æ¬¡éƒ½ä¼šå»è¿›è¡Œè°ƒç”¨ï¼Œè€Œä¸ä¼šç¼“å­˜ç»“æœã€‚</p><h2 id="mutations" tabindex="-1"><a class="header-anchor" href="#mutations" aria-hidden="true">#</a> mutations</h2><p>æ›´æ”¹ Vuex çš„ store ä¸­çš„çŠ¶æ€ï¼ˆå³ä¿®æ”¹ <code>state</code> å¯¹è±¡çš„å±æ€§ï¼‰çš„å”¯ä¸€æ–¹æ³•æ˜¯ <code>commit</code>ï¼ˆæäº¤ï¼‰mutationï¼Œè¿™æ˜¯ä¸ºäº†æ–¹ä¾¿è°ƒè¯•å·¥å…· devtool å¯¹åº”ç”¨çŠ¶æ€è¿›è¡Œè·Ÿè¸ªã€‚</p><p>âš ï¸ å¦ä¸€ä¸ªå¿…è¦éµå®ˆçš„åŸåˆ™æ˜¯ <strong>mutation å¿…é¡»æ˜¯åŒæ­¥å‡½æ•°</strong>ï¼Œå› ä¸º devtools ä¼šè®°å½•æ¯ä¸€æ¡ mutationï¼Œå¹¶æ•æ‰å‰ä¸€çŠ¶æ€å’Œåä¸€çŠ¶æ€çš„å¿«ç…§ï¼Œå¦‚æœ mutation ä¸­å­˜åœ¨å¼‚æ­¥å‡½æ•°ï¼Œåˆ™ä½¿å¾—çŠ¶æ€çš„æ”¹å˜ä¸å¯è¿½è¸ªäº†ã€‚</p><p>Vuex ä¸­çš„ mutation éå¸¸ç±»ä¼¼äºäº‹ä»¶ï¼Œæ¯ä¸ª mutation éƒ½ç”±ä¸€ä¸ªå­—ç¬¦ä¸²çš„ <strong>äº‹ä»¶ç±»å‹ type</strong>å’Œ ä¸€ä¸ª <strong>å›è°ƒå‡½æ•° handler</strong>æ„æˆã€‚mutation handler ä¸èƒ½ç›´æ¥è°ƒç”¨ï¼Œè€Œåº”è¯¥åƒæ˜¯äº‹ä»¶æ³¨å†Œä¸€æ ·ï¼Œç”± store çš„æ–¹æ³• <code>.commit()</code> æäº¤è§¦å‘ã€‚</p><p>åœ¨ Vuex çš„ store ä¸­çš„å¯¹è±¡ <code>mutations</code> ä¸­å£°æ˜å„ç§ mutationï¼Œå…¶å±æ€§å<strong>ä¸€èˆ¬ä½¿ç”¨å¸¸é‡ï¼Œå³å…¨å¤§å†™å­—æ¯è¡¨ç¤º</strong>ï¼Œå®ƒç±»ä¼¼äº <strong>äº‹ä»¶ç±»å‹ type</strong> ï¼›å›è°ƒå‡½æ•° mutation handler æ¥å— <code>state</code> ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ï¼Œåœ¨å‡½æ•°å†…ä¼šä¿®æ”¹ <code>state</code> å¯¹è±¡ä¸­çš„å±æ€§ï¼Œä»¥æ›´æ”¹åº”ç”¨çš„çŠ¶æ€ï¼›ç¬¬äºŒä¸ªï¼ˆå¯é€‰ï¼‰å‚æ•° <code>payload</code> æ¥æ”¶ <code>commit</code> æ—¶ä¼ é€’è¿›æ¥çš„é¢å¤–æ•°æ®ï¼Œåœ¨å¤§å¤šæ•°æƒ…å†µä¸‹è½½è·åº”è¯¥æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œè¿™æ ·å¯ä»¥åŒ…å«å¤šä¸ªå­—æ®µã€‚</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vuex<span class="token punctuation">.</span>Store</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  state<span class="token operator">:</span> <span class="token punctuation">{</span>
    count<span class="token operator">:</span> <span class="token number">1</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  mutations<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token constant">INCREMENT</span> <span class="token punctuation">(</span><span class="token parameter">state</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// å˜æ›´çŠ¶æ€</span>
      state<span class="token punctuation">.</span>count<span class="token operator">++</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>åœ¨ç»„ä»¶ä¸­ä½¿ç”¨ <code>this.$store.commit(TYPE, [payload])</code> æäº¤è§¦å‘ç‰¹å®šç±»å‹ <code>TYPE</code> çš„ mutationï¼Œç¬¬äºŒä¸ªå¯é€‰å‚æ•°ç§°ä¸º è½½è· <code>payload</code>ï¼Œä½œä¸ºé¢å¤–çš„å‚æ•°ä¼ å…¥åˆ° mutation handlerï¼›åœ¨ store å¯¹è±¡çš„å±æ€§ <code>actions</code> ä¸­ä½¿ç”¨ <code>context.commit()</code> æäº¤è§¦å‘ mutationã€‚</p><p>âš ï¸ åœ¨åˆ›å»º store ä¼ å…¥ <code>strict: true</code> å¼€å¯ä¸¥æ ¼æ¨¡å¼</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>const store = new Vuex.Store({
  // ...
  strict: true
})

</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>åœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹å¦‚æœåº”ç”¨çš„çŠ¶æ€å˜æ›´ä¸æ˜¯ç”± mutation å¼•èµ·çš„å°†ä¼šæŠ›å‡ºé”™è¯¯ï¼Œè¿™èƒ½ä¿è¯æ‰€æœ‰çš„çŠ¶æ€å˜æ›´éƒ½èƒ½è¢«è°ƒè¯•å·¥å…·è·Ÿè¸ªåˆ°ã€‚</p><h2 id="actions" tabindex="-1"><a class="header-anchor" href="#actions" aria-hidden="true">#</a> actions</h2><p>Action ç›¸å½“äºç»„ä»¶çš„ methodsï¼Œå¯ä»¥åœ¨ç»„ä»¶ä¸­è°ƒç”¨ Vuex çš„ store å¯¹è±¡ä¸­çš„ action æ‰§è¡Œç‰¹å®šçš„æ“ä½œã€‚</p><p>å®ƒç±»ä¼¼äº mutationï¼Œä¸åŒåœ¨äºï¼š</p><ul><li>Action éœ€è¦é€šè¿‡ commit æäº¤ mutation å˜æ›´åº”ç”¨çŠ¶æ€ï¼Œè€Œä¸èƒ½ç›´æ¥æ“ä½œ <code>state</code></li><li>Action å¯ä»¥åŒ…å«ä»»æ„<strong>å¼‚æ­¥æ“ä½œ</strong></li></ul><p>Action å‡½æ•°ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å›ºå®šçš„ <code>context</code>ï¼Œå®ƒæ˜¯ä¸ store å®ä¾‹å…·æœ‰ç›¸åŒæ–¹æ³•å’Œå±æ€§çš„å¯¹è±¡ï¼Œå› æ­¤ä½ å¯ä»¥è°ƒç”¨ <code>context.commit</code> æäº¤ä¸€ä¸ª mutationï¼Œæˆ–è€…é€šè¿‡ <code>context.state</code> å’Œ <code>context.getters</code> æ¥è·å– <code>state</code>ï¼ˆä½†ä¸èƒ½ä¿®æ”¹ <code>state</code>ï¼‰ å’Œ <code>getters</code>ï¼›ç¬¬äºŒä¸ªï¼ˆå¯é€‰ï¼‰å‚æ•°æ˜¯ payload è½½è·æ¥æ”¶ä¼ é€’è¿›æ¥çš„é¢å¤–æ•°æ®</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vuex<span class="token punctuation">.</span>Store</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  state<span class="token operator">:</span> <span class="token punctuation">{</span>
    count<span class="token operator">:</span> <span class="token number">0</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  mutations<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">increment</span> <span class="token punctuation">(</span><span class="token parameter">state</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      state<span class="token punctuation">.</span>count<span class="token operator">++</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  actions<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">increment</span> <span class="token punctuation">(</span><span class="token parameter">context</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// æäº¤ mutaion</span>
      context<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">&#39;increment&#39;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>åœ¨ç»„ä»¶ä¸­é€šè¿‡æ–¹æ³• <code>this.$store.dispatch(actionName, [payload])</code> åˆ†å‘ actionï¼›åœ¨ action ä¸­è°ƒç”¨å¦å¤–çš„ action å¯ä»¥ä½¿ç”¨ <code>context.dispatch(actionName, [payload])</code>ã€‚</p><p>ğŸ’¡ å¦‚æœéœ€è¦ä¼ é€’å¤šä¸ªé¢å¤–å‚æ•°ï¼Œå¯ä»¥ã€Œæ‰“åŒ…ã€æˆä¸€ä¸ªå¯¹è±¡ä½œä¸ºè½½è·ï¼Œè¿™æ ·å¯ä»¥åŒ…å«å¤šä¸ªå­—æ®µï¼Œè€Œåœ¨ store çš„ action ä¸­ä½¿ç”¨å¯¹è±¡è§£æ„çš„æ–¹æ³•æ¥æå–å…¶ä¸­çš„å„ä¸ªå±æ€§å€¼ã€‚</p><div class="language-vue ext-vue line-numbers-mode"><pre class="language-vue"><code>// ç»„ä»¶
// ä»¥å¯¹è±¡ä½œä¸ºè½½è·å½¢å¼åˆ†å‘ actionï¼Œä¼ é€’å¤šä¸ªæ•°æ®
this.$store.dispatch(&#39;addtoCart&#39;, { id, qty });
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vuex<span class="token punctuation">.</span>Store</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
  actions<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// ç¬¬äºŒä¸ªå‚æ•°æ¥æ”¶çš„æ˜¯å¯¹è±¡ï¼Œä½¿ç”¨è§£æ„å°†è¯¥å¯¹è±¡çš„æ¯ä¸ªå±æ€§å€¼èµ‹ç»™ç›¸åº”çš„å˜é‡</span>
    <span class="token function">addtoCart</span><span class="token punctuation">(</span><span class="token parameter">context<span class="token punctuation">,</span> <span class="token punctuation">{</span> id<span class="token punctuation">,</span> qty <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// ...</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h2 id="è¾…åŠ©å‡½æ•°" tabindex="-1"><a class="header-anchor" href="#è¾…åŠ©å‡½æ•°" aria-hidden="true">#</a> è¾…åŠ©å‡½æ•°</h2><h3 id="mapstate" tabindex="-1"><a class="header-anchor" href="#mapstate" aria-hidden="true">#</a> mapState</h3><p>å½“ä¸€ä¸ªç»„ä»¶éœ€è¦è·å–å¤šä¸ªçŠ¶æ€çš„æ—¶å€™ï¼Œå°†è¿™äº›çŠ¶æ€éƒ½åˆ†åˆ«å£°æ˜ä¸ºè®¡ç®—å±æ€§ä¼šæœ‰äº›é‡å¤å’Œå†—ä½™ï¼Œä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜å¯ä»¥ä½¿ç”¨ <code>mapState</code> è¾…åŠ©å‡½æ•°å¸®åŠ©æˆ‘ä»¬ï¼ˆ<a href="https://scrimba.com/p/pnyzgAP/c8Pz7BSK" target="_blank" rel="noopener noreferrer">æœ‰å¤šç§ä½¿ç”¨æ–¹å¼</a>ï¼‰ç”Ÿæˆè®¡ç®—å±æ€§ã€‚</p><div class="language-vue ext-vue line-numbers-mode"><pre class="language-vue"><code>// ç»„ä»¶
import { mapState } from &#39;vuex&#39;

export default {
  // ...
  // æœ‰å¤šç§æ–¹å¼ä½¿ç”¨ mapState è¾…åŠ©å‡½æ•°æ„å»ºç»„ä»¶çš„è®¡ç®—å±æ€§
  computed: mapState({
    // ç®­å¤´å‡½æ•°å¯ä½¿ä»£ç æ›´ç®€ç»ƒ
    count: state =&gt; state.count,

    // ä¼ å­—ç¬¦ä¸²å‚æ•° &#39;count&#39; ç­‰åŒäº `state =&gt; state.count`
    // è®¡ç®—å±æ€§é‡å‘½åä¸º countAlias
    countAlias: &#39;count&#39;,

    // ä¸ºäº†èƒ½å¤Ÿä½¿ç”¨ `this` è·å–å±€éƒ¨çŠ¶æ€ï¼ˆéœ€è¦ä½¿ç”¨ç»„ä»¶çš„æ•°æ®å¯¹è±¡ data ä¸­æœ‰ localCountï¼‰ï¼Œå¿…é¡»ä½¿ç”¨å¸¸è§„å‡½æ•°
    countPlusLocalState (state) {
      return state.count + this.localCount
    }
  })
}
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p>ğŸ’¡ å¦‚æœä½¿ç”¨è¾…åŠ©å‡½æ•° <code>mapState</code> æ„é€ çš„è®¡ç®—å±æ€§éœ€è¦ä¸å±€éƒ¨è®¡ç®—å±æ€§æ··åˆä½¿ç”¨ï¼Œç”±äº <code>mapState</code> å‡½æ•°è¿”å›çš„æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œæˆ‘ä»¬å°±éœ€è¦ä½¿ç”¨å¯¹è±¡å±•å¼€è¿ç®—ç¬¦å°†è¯¥å¯¹è±¡çš„å±æ€§éƒ½è§£æ„ã€‚</p><div class="language-vue ext-vue line-numbers-mode"><pre class="language-vue"><code>// ç»„ä»¶
import { mapState } from &#39;vuex&#39;

export default {
  // ...
  computed: {
  // ç»„ä»¶çš„å±€éƒ¨è®¡ç®—å±æ€§
    localComputed () { /* ... */ },
    // ä½¿ç”¨å¯¹è±¡å±•å¼€è¿ç®—ç¬¦å°†æ­¤å¯¹è±¡æ··å…¥åˆ°å¤–éƒ¨å¯¹è±¡ä¸­
    ...mapState({
      // ...
    })
  }
}
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>ğŸ’¡ å½“æ˜ å°„çš„è®¡ç®—å±æ€§çš„åç§°ä¸ state çš„å­èŠ‚ç‚¹åç§°ç›¸åŒæ—¶ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ç»™ mapState ä¼ ä¸€ä¸ªå­—ç¬¦ä¸²æ•°ç»„</p><div class="language-vue ext-vue line-numbers-mode"><pre class="language-vue"><code>// ç»„ä»¶
import { mapState } from &#39;vuex&#39;

export default {
  // ...
  computed: mapState([
    // æ˜ å°„ this.count ä¸º store.state.count
    &#39;count&#39;
  ])
}
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h3 id="mapgetters" tabindex="-1"><a class="header-anchor" href="#mapgetters" aria-hidden="true">#</a> mapGetters</h3><p>è¾…åŠ©å‡½æ•° <code>mapGetters</code> ä»…ä»…æ˜¯å°† store ä¸­çš„ getter æ˜ å°„åˆ°ç»„ä»¶ä¸­ï¼Œä½œä¸ºå…¶å±€éƒ¨è®¡ç®—å±æ€§</p><div class="language-vue ext-vue line-numbers-mode"><pre class="language-vue"><code>// ç»„ä»¶
import { mapGetters } from &#39;vuex&#39;

export default {
  // ...
  computed: {
  // ä½¿ç”¨å¯¹è±¡å±•å¼€è¿ç®—ç¬¦å°† getter æ··å…¥ computed å¯¹è±¡ä¸­
  // åœ¨å‡½æ•° mapGetters ä¸­ä¼ é€’ä¸€ä¸ªæ•°ç»„ï¼Œå…¶å…ƒç´ æ˜¯éœ€è¦è¯»å–çš„ store ä¸­çš„ getter
    ...mapGetters([
      &#39;doneTodosCount&#39;,
      &#39;anotherGetter&#39;,
      // ...
    ])
  }
}
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>ğŸ’¡ å¦‚æœä½ æƒ³å°†ä¸€ä¸ª getter å±æ€§å¦å–ä¸€ä¸ªåå­—ï¼Œä½¿ç”¨å¯¹è±¡å½¢å¼ï¼š</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>...mapGetters({
  // æŠŠ `this.doneCount` æ˜ å°„ä¸º `this.$store.getters.doneTodosCount`
  doneCount: &#39;doneTodosCount&#39;
})
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="mapmutations" tabindex="-1"><a class="header-anchor" href="#mapmutations" aria-hidden="true">#</a> mapMutations</h3><p>å¯ä»¥ä½¿ç”¨ <code>mapMutations</code> è¾…åŠ©å‡½æ•°å°†ç»„ä»¶å®ä¾‹ç›¸åº”çš„æ–¹æ³•æ˜ å°„ä¸º <code>store.commit</code>ï¼Œä¾¿äºåœ¨ç»„ä»¶ä¸­è°ƒç”¨ï¼ˆéœ€è¦åœ¨æ ¹èŠ‚ç‚¹æ³¨å…¥ <code>store</code>ï¼Œå‚è€ƒ <a href="#state">state ä¸€èŠ‚ä¸­å°† store ä»æ ¹ç»„ä»¶ <code>App.vue</code>ã€Œæ³¨å…¥ã€åˆ°æ¯ä¸€ä¸ªå­ç»„ä»¶ä¸­</a>ï¼‰</p><div class="language-vue ext-vue line-numbers-mode"><pre class="language-vue"><code>import { mapMutations } from &#39;vuex&#39;

export default {
  // ...
  methods: {
    ...mapMutations([
      &#39;increment&#39;, // å°† `this.increment()` æ˜ å°„ä¸º `this.$store.commit(&#39;increment&#39;)`

      // `mapMutations` ä¹Ÿæ”¯æŒè½½è·ï¼š
      &#39;incrementBy&#39; // å°† `this.incrementBy(amount)` æ˜ å°„ä¸º `this.$store.commit(&#39;incrementBy&#39;, amount)`
    ]),
    ...mapMutations({
      add: &#39;increment&#39; // å°† `this.add()` æ˜ å°„ä¸º `this.$store.commit(&#39;increment&#39;)`
    })
  }
}
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h3 id="mapactions" tabindex="-1"><a class="header-anchor" href="#mapactions" aria-hidden="true">#</a> mapActions</h3><p>ä½¿ç”¨ <code>mapActions</code> è¾…åŠ©å‡½æ•°å°†ç»„ä»¶çš„ methods æ˜ å°„ä¸º <code>store.dispatch</code> è°ƒç”¨ï¼ˆéœ€è¦å…ˆåœ¨æ ¹èŠ‚ç‚¹æ³¨å…¥ <code>store</code>ï¼‰ï¼Œå‡½æ•°æ¥æ”¶</p><div class="language-vue ext-vue line-numbers-mode"><pre class="language-vue"><code>import { mapActions } from &#39;vuex&#39;

export default {
  // ...
  methods: {
    ...mapActions([
      &#39;increment&#39;, // å°† `this.increment()` æ˜ å°„ä¸º `this.$store.dispatch(&#39;increment&#39;)`

      // `mapActions` ä¹Ÿæ”¯æŒè½½è·ï¼š
      &#39;incrementBy&#39; // å°† `this.incrementBy(amount)` æ˜ å°„ä¸º `this.$store.dispatch(&#39;incrementBy&#39;, amount)`
    ]),
    ...mapActions({
      add: &#39;increment&#39; // å°† `this.add()` æ˜ å°„ä¸º `this.$store.dispatch(&#39;increment&#39;)`
    })
  }
}
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h2 id="é¡¹ç›®ç»“æ„" tabindex="-1"><a class="header-anchor" href="#é¡¹ç›®ç»“æ„" aria-hidden="true">#</a> é¡¹ç›®ç»“æ„</h2><p>Vuex å¹¶ä¸é™åˆ¶ä»£ç ç»“æ„ï¼Œä½†æ˜¯å®ƒè§„å®šäº†ä¸€äº›éœ€è¦éµå®ˆçš„è§„åˆ™ï¼š</p><ul><li>åº”ç”¨å±‚çº§çš„çŠ¶æ€åº”è¯¥é›†ä¸­åˆ°å•ä¸ª store å¯¹è±¡ä¸­ã€‚</li><li>æäº¤ <strong>mutation</strong> æ˜¯æ›´æ”¹çŠ¶æ€çš„å”¯ä¸€æ–¹æ³•ï¼Œå¹¶ä¸”è¿™ä¸ªè¿‡ç¨‹æ˜¯åŒæ­¥çš„ã€‚</li><li>å¼‚æ­¥é€»è¾‘éƒ½åº”è¯¥å°è£…åˆ° <strong>action</strong> é‡Œé¢ã€‚</li><li>å¦‚æœä½ çš„ store æ–‡ä»¶å¤ªå¤§ï¼Œåªéœ€å°† <code>actions</code>ã€<code>mutations</code> å’Œ <code>getters</code> åˆ†å‰²åˆ°å•ç‹¬çš„æ–‡ä»¶ <code>*.js</code> å¹¶å­˜æ”¾åœ¨ç›®å½• <code>modules</code> ä¸‹ã€‚</li></ul><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code># é¡¹ç›®ç»“æ„ç¤ºä¾‹

â”œâ”€â”€ index.html
â”œâ”€â”€ main.js
â”œâ”€â”€ api
â”‚   â””â”€â”€ ... # æŠ½å–å‡ºAPIè¯·æ±‚
â”œâ”€â”€ components
â”‚   â”œâ”€â”€ App.vue
â”‚   â””â”€â”€ ...
â””â”€â”€ store
    â”œâ”€â”€ index.js          # æˆ‘ä»¬ç»„è£…æ¨¡å—å¹¶å¯¼å‡º store çš„åœ°æ–¹
    â”œâ”€â”€ actions.js        # æ ¹çº§åˆ«çš„ action
    â”œâ”€â”€ mutations.js      # æ ¹çº§åˆ«çš„ mutation
    â””â”€â”€ modules
        â”œâ”€â”€ cart.js       # è´­ç‰©è½¦æ¨¡å—
        â””â”€â”€ products.js   # äº§å“æ¨¡å—
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h2 id="module" tabindex="-1"><a class="header-anchor" href="#module" aria-hidden="true">#</a> module</h2><p>ç”±äºä½¿ç”¨å•ä¸€çŠ¶æ€æ ‘ï¼Œåº”ç”¨çš„æ‰€æœ‰çŠ¶æ€ä¼šé›†ä¸­åˆ°ä¸€ä¸ªæ¯”è¾ƒå¤§çš„å¯¹è±¡ã€‚å½“åº”ç”¨å˜å¾—éå¸¸å¤æ‚æ—¶ï¼Œstore å¯¹è±¡å°±æœ‰å¯èƒ½å˜å¾—ç›¸å½“è‡ƒè‚¿ã€‚</p><p>ä¸ºäº†è§£å†³ä»¥ä¸Šé—®é¢˜ï¼ŒVuex å…è®¸æˆ‘ä»¬å°† store åˆ†å‰²æˆ<strong>æ¨¡å—ï¼ˆmoduleï¼‰</strong>ã€‚æ¯ä¸ªæ¨¡å—æ‹¥æœ‰è‡ªå·±çš„ stateã€mutationã€actionã€getterã€ç”šè‡³æ˜¯åµŒå¥—å­æ¨¡å—ã€‚</p><p>é€šè¿‡ store çš„å±æ€§ <code>modules</code> å°†å„ä¸ªæ¨¡å—ã€Œæ±‡æ€»ã€åˆ°ä»“åº“ä¸­</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> moduleA <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">state</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  mutations<span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  actions<span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  getters<span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> moduleB <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">state</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  mutations<span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  actions<span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vuex<span class="token punctuation">.</span>Store</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
  <span class="token comment">// å°†å…¶ä»–æ¨¡å—ã€Œå¯¼å…¥ã€åˆ°æ ¹èŠ‚ç‚¹ä¸­</span>
  modules<span class="token operator">:</span> <span class="token punctuation">{</span>
    a<span class="token operator">:</span> moduleA<span class="token punctuation">,</span>
    b<span class="token operator">:</span> moduleB
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

store<span class="token punctuation">.</span>state<span class="token punctuation">.</span>a <span class="token comment">// -&gt; moduleA çš„çŠ¶æ€</span>
store<span class="token punctuation">.</span>state<span class="token punctuation">.</span>b <span class="token comment">// -&gt; moduleB çš„çŠ¶æ€</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><h3 id="å±€éƒ¨çŠ¶æ€" tabindex="-1"><a class="header-anchor" href="#å±€éƒ¨çŠ¶æ€" aria-hidden="true">#</a> å±€éƒ¨çŠ¶æ€</h3><p>ä½¿ç”¨æ¨¡å—é‡æ„ store å¯¹è±¡åä¼šå‡ºç°å±‚çº§å…³ç³»ï¼Œåœ¨æ¨¡å—å†…çš„ mutationã€getterã€action ç­‰å‡½æ•°ä½¿ç”¨çš„ä¸­çš„ <code>state</code> æ˜¯æŒ‡æ¨¡å—çš„å±€éƒ¨çŠ¶æ€ï¼Œå¦‚æœå¸Œæœ›ä½¿ç”¨æ ¹èŠ‚ç‚¹çš„çŠ¶æ€åˆ™éœ€è¦ä½¿ç”¨å¦å¤–çš„å‚æ•°ã€‚</p><p>å¯¹äºæ¨¡å—å†…éƒ¨çš„ mutation å’Œ getterï¼Œæ¥æ”¶çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯<strong>æ¨¡å—çš„å±€éƒ¨çŠ¶æ€å¯¹è±¡</strong>ã€‚</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> moduleA <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">state</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
    count<span class="token operator">:</span> <span class="token number">0</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  mutations<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">increment</span> <span class="token punctuation">(</span><span class="token parameter">state</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// è¿™é‡Œçš„ `state` å¯¹è±¡æ˜¯æ¨¡å—çš„å±€éƒ¨çŠ¶æ€</span>
      state<span class="token punctuation">.</span>count<span class="token operator">++</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  getters<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">doubleCount</span> <span class="token punctuation">(</span><span class="token parameter">state</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> state<span class="token punctuation">.</span>count <span class="token operator">*</span> <span class="token number">2</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>å¯¹äºæ¨¡å—å†…éƒ¨çš„ actionï¼Œå±€éƒ¨çŠ¶æ€é€šè¿‡ <code>context.state</code> æš´éœ²å‡ºæ¥ï¼Œ<strong>æ ¹èŠ‚ç‚¹çŠ¶æ€åˆ™ä¸º <code>context.rootState</code></strong></p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> moduleA <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
  actions<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">incrementIfOddOnRootSum</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> state<span class="token punctuation">,</span> commit<span class="token punctuation">,</span> rootState <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>state<span class="token punctuation">.</span>count <span class="token operator">+</span> rootState<span class="token punctuation">.</span>count<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">===</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">&#39;increment&#39;</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>å¯¹äºæ¨¡å—å†…éƒ¨çš„ getterï¼Œ<strong>æ ¹èŠ‚ç‚¹çŠ¶æ€ä¼šä½œä¸ºç¬¬ä¸‰ä¸ªå‚æ•°æš´éœ²å‡ºæ¥</strong>ï¼ˆç¬¬äºŒä¸ªå‚æ•°æ˜¯å…¶ä»–çš„ getterï¼‰</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> moduleA <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
  getters<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">sumWithRootCount</span> <span class="token punctuation">(</span><span class="token parameter">state<span class="token punctuation">,</span> getters<span class="token punctuation">,</span> rootState</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> state<span class="token punctuation">.</span>count <span class="token operator">+</span> rootState<span class="token punctuation">.</span>count
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="å‘½åç©ºé—´" tabindex="-1"><a class="header-anchor" href="#å‘½åç©ºé—´" aria-hidden="true">#</a> å‘½åç©ºé—´</h3><p>é»˜è®¤æƒ…å†µä¸‹æ¨¡å—å†…éƒ¨çš„ actionã€mutation å’Œ getter æ˜¯æ³¨å†Œåœ¨<strong>å…¨å±€å‘½åç©ºé—´</strong>çš„ï¼Œå³å¤šä¸ªæ¨¡å—èƒ½å¤Ÿè°ƒç”¨å…¶ä»–æ¨¡å—ä¸­å£°æ˜çš„ actionã€mutationã€getterï¼Œå¹¶å¯¹å…¶ä»–å…¶ä»–æ¨¡å—çš„è§¦å‘çš„æ“ä½œä½œå‡ºå“åº”ã€‚</p><p>å¦‚æœå¸Œæœ›ä½ çš„æ¨¡å—å…·æœ‰æ›´é«˜çš„å°è£…åº¦å’Œå¤ç”¨æ€§ï¼Œä½ å¯ä»¥é€šè¿‡æ·»åŠ  <code>namespaced: true</code> çš„æ–¹å¼ä½¿å…¶æˆä¸ºå¸¦å‘½åç©ºé—´çš„æ¨¡å—ï¼Œå®ƒçš„æ‰€æœ‰ getterã€action åŠ mutation éƒ½ä¼šè‡ªåŠ¨æ ¹æ®æ¨¡å—æ³¨å†Œçš„è·¯å¾„è°ƒæ•´å‘½åï¼Œå¯ç”¨äº†å‘½åç©ºé—´çš„ getter å’Œ action ä¼šæ”¶åˆ°å±€éƒ¨åŒ–çš„ <code>getter</code>ï¼Œ<code>dispatch</code> å’Œ <code>commit</code>ï¼Œè¿™æ ·å³æ—¶åœ¨ä¸åŒæ¨¡å—ä¸­å‘½åäº†ç›¸åŒåç§°çš„ getterã€action æˆ– mutation ä¹Ÿä¸æ€•ä¼šå‡ºç°å†²çªã€‚</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vuex<span class="token punctuation">.</span>Store</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  modules<span class="token operator">:</span> <span class="token punctuation">{</span>
    account<span class="token operator">:</span> <span class="token punctuation">{</span>
      namespaced<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      <span class="token comment">// æ¨¡å—å†…å®¹</span>
      <span class="token comment">// è®¿é—®æˆ–è°ƒç”¨å‘½åæ¨¡å—çš„å±æ€§æ—¶ï¼Œä¼šè‡ªåŠ¨æ ¹æ®æ¨¡å—æ³¨å†Œçš„è·¯å¾„è°ƒæ•´å‘½å</span>
      <span class="token function-variable function">state</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      getters<span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token function">isAdmin</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span> <span class="token comment">// -&gt; getters[&#39;account/isAdmin&#39;]</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      actions<span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token function">login</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span> <span class="token comment">// -&gt; dispatch(&#39;account/login&#39;)</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      mutations<span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token function">login</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span> <span class="token comment">// -&gt; commit(&#39;account/login&#39;)</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>ğŸ’¡ å¦‚æœä½ å¸Œæœ›åœ¨å‘½åæ¨¡å—ä¸­ä½¿ç”¨å…¨å±€ state å’Œ getterï¼Œ<code>rootState</code> å’Œ <code>rootGetters</code> ä¼šä½œä¸ºç¬¬ä¸‰å’Œç¬¬å››å‚æ•°ä¼ å…¥ getterï¼Œä¹Ÿä¼šé€šè¿‡ <code>context</code> å¯¹è±¡çš„å±æ€§ä¼ å…¥ actionã€‚è‹¥éœ€è¦åœ¨å‘½åç©ºé—´å†…åˆ†å‘å…¨å±€çš„ action æˆ–æäº¤ mutationï¼Œå°† <code>{ root: true }</code> ä½œä¸ºç¬¬ä¸‰å‚æ•°ä¼ ç»™ <code>dispatch</code> æˆ– <code>commit</code> å³å¯ã€‚</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>modules<span class="token operator">:</span> <span class="token punctuation">{</span>
  foo<span class="token operator">:</span> <span class="token punctuation">{</span>
    namespaced<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>

    getters<span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token comment">// åœ¨è¿™ä¸ªæ¨¡å—çš„ getter ä¸­ï¼Œ`getters` è¢«å±€éƒ¨åŒ–äº†</span>
      <span class="token comment">// ä½ å¯ä»¥ä½¿ç”¨ getter çš„ç¬¬å››ä¸ªå‚æ•°æ¥è°ƒç”¨ `rootGetters`</span>
      <span class="token function">someGetter</span> <span class="token punctuation">(</span><span class="token parameter">state<span class="token punctuation">,</span> getters<span class="token punctuation">,</span> rootState<span class="token punctuation">,</span> rootGetters</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        getters<span class="token punctuation">.</span>someOtherGetter <span class="token comment">// -&gt; &#39;foo/someOtherGetter&#39;</span>
        rootGetters<span class="token punctuation">.</span>someOtherGetter <span class="token comment">// -&gt; &#39;someOtherGetter&#39;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token function-variable function">someOtherGetter</span><span class="token operator">:</span> <span class="token parameter">state</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>

    actions<span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token comment">// åœ¨è¿™ä¸ªæ¨¡å—ä¸­ï¼Œ dispatch å’Œ commit ä¹Ÿè¢«å±€éƒ¨åŒ–äº†</span>
      <span class="token comment">// ä»–ä»¬å¯ä»¥æ¥å— `root` å±æ€§ä»¥è®¿é—®æ ¹ dispatch æˆ– commit</span>
      <span class="token function">someAction</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> dispatch<span class="token punctuation">,</span> commit<span class="token punctuation">,</span> getters<span class="token punctuation">,</span> rootGetters <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        getters<span class="token punctuation">.</span>someGetter <span class="token comment">// -&gt; &#39;foo/someGetter&#39;</span>
        rootGetters<span class="token punctuation">.</span>someGetter <span class="token comment">// -&gt; &#39;someGetter&#39;</span>

        <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token string">&#39;someOtherAction&#39;</span><span class="token punctuation">)</span> <span class="token comment">// -&gt; &#39;foo/someOtherAction&#39;</span>
        <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token string">&#39;someOtherAction&#39;</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> root<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment">// -&gt; &#39;someOtherAction&#39;</span>

        <span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">&#39;someMutation&#39;</span><span class="token punctuation">)</span> <span class="token comment">// -&gt; &#39;foo/someMutation&#39;</span>
        <span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">&#39;someMutation&#39;</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> root<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment">// -&gt; &#39;someMutation&#39;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token function">someOtherAction</span> <span class="token punctuation">(</span><span class="token parameter">ctx<span class="token punctuation">,</span> payload</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><!--]--></div><footer class="page-meta"><!----><div class="meta-item last-updated"><span class="meta-item-label">æ›´æ–°æ—¶é—´: </span><span class="meta-item-info">2021/7/6 ä¸Šåˆ2:38:22</span></div><!----></footer><!----><!--[--><!--]--></main><!--]--></div><div style="width:0px;" class="catalog-container absolute top-0 right-0 h-full hidden lg:block"><div class="headings-container sticky top-36" data-v-c28348e0><ul class="max-w-max m-2 pl-7 xl:pl-16 2xl:pl-20 py-4 opacity-50 hover:opacity-100 transition-all duration-300" data-v-c28348e0><!--[--><!--]--></ul></div></div><div style="display:none;" tabindex="0" class="sidebar-container fixed inset-y-0 left-0 z-20 lg:hidden opacity-10 hover:opacity-95"><div class="headings-container px-2 space-y-2 transition-all duration-300 py-20" data-v-6eed9461><!--[--><!--]--></div></div></div><footer class="bg-gray-200 p-8 grid grid-cols-1 md:grid-cols-3 gap-4 items-center"><div class="flex justify-center md:justify-start items-center"><a class="p-2 hover:bg-gray-300 rounded-md" href="https://benbinbin.github.io/" target="_blank"><img src="/blog-web/images/avatar.png" alt="avatar" class="w-10 h-10 rounded-full"></a></div><div class="text-center space-y-0.5"><p class="text-sm text-gray-600"> Â©2021 <span class="author">Benbinbin</span>. All Right Reserved. </p><p class="text-xs text-center text-gray-400"> é™¤ç‰¹æ®Šè¯´æ˜å¤–ï¼Œæœ¬ç«™çš„æ–‡ç« éµå¾ª <a href="https://creativecommons.org/licenses/by-sa/4.0/deed.en" target="_blank" class="text-blue-400">CC-BY-SA-4.0</a> åè®® </p><p class="text-xs text-center text-gray-400"> ç½‘ç«™ä¸»é¢˜é‡‡ç”¨ <a href="https://github.com/Benbinbin/two-dishes-one-fish" target="_blank" class="text-blue-400">Two Dishes One Fish</a></p></div><div class="btn-container flex justify-center md:justify-end items-center space-x-0.5"><!--[--><a class="p-2 hover:bg-gray-300 rounded-md" href="mailto:benthomsonbin@gmail.com" target=""><img src="/blog-web/images/icons/email.svg" alt="email" class="w-auto h-6"></a><a class="p-2 hover:bg-gray-300 rounded-md" href="https://github.com/Benbinbin" target="_blank"><img src="/blog-web/images/icons/github.svg" alt="github" class="w-auto h-6"></a><a class="p-2 hover:bg-gray-300 rounded-md" href="https://juejin.cn/user/3175045314389278/posts" target="_blank"><img src="/blog-web/images/icons/juejin.svg" alt="juejin" class="w-auto h-6"></a><a class="p-2 hover:bg-gray-300 rounded-md" href="https://dribbble.com/BinBinDesign" target="_blank"><img src="/blog-web/images/icons/dribbble.svg" alt="dribbble" class="w-auto h-6"></a><a class="p-2 hover:bg-gray-300 rounded-md" href="https://twitter.com/Benbinbin_fun" target="_blank"><img src="/blog-web/images/icons/twitter.svg" alt="twitter" class="w-auto h-6"></a><a class="p-2 hover:bg-gray-300 rounded-md" href="https://weibo.com/binbindesign" target="_blank"><img src="/blog-web/images/icons/weibo.svg" alt="weibo" class="w-auto h-6"></a><!--]--></div></footer></div><!--]--></div>
    <script type="module" src="/blog-web/assets/app.43fe0c63.js" defer></script>
  </body>
</html>
